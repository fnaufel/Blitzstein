---
knit: "bookdown::render_book"
---

# 05: Probabilidade condicional (continuação) {-}

## Vídeo {-}

```{r echo=FALSE, results='asis', out.extra=center()}
embed_yt('JzDvVgNDxo8')
```


## Exercícios do livro (cap. 2) {-}

### 30 {-}

::: {.rmdbox latex=1}

Uma família tem $3$ filhos: $A$, $B$ e $C$.

a. O evento "$A$ é mais velho que $B$" é independente de "$A$ é mais velho que $C$"?

:::

* Intuitivamente: 

  Não, pois $A$ ser mais velho que $B$ torna mais provável que $A$ seja mais velho que $C$.

::: {.rmdbox latex=1}

b. Qual a probabilidade de que $A$ é mais velho que $B$, dado que $A$ é mais velho que $C$?

:::

* Queremos achar $P(A > B \mid A > C)$.

* Esta probabilidade é igual a 

  $$
  \frac{P(A > B,  A > C)}{P(A > C)}
  $$

* O numerador é a probabilidade de $A$ ser o mais velho.

* Se todas as $6$ ordens de nascimento tiverem a mesma probabilidade,

  $$
  P(A > B,  A > C) = 2/6 = 1/3
  $$

* O denominador é

  $$
  P(A > C) = 3/6 = 1/2
  $$

* Daí, $P(A > B \mid A > C) = \frac{1/3}{1/2} = \frac23$.

* De fato, a probabilidade [condicional]{.hl} $P(A > B \mid A > C) = 2/3$ é [maior]{.hl} do que a probabilidade [não-condicional]{.hl} $P(A > B) = 1/2$.


### 31 {-}

::: {.rmdbox latex=1}

Um evento pode ser independente de si mesmo?

:::

* Chamando este evento de $A$, é preciso que

  $$
  P(A \cap A) = P(A) = P(A) \cdot P(A)
  $$

* Isto só é possível se $P(A) = 0$ ou se $P(A) = 1$.


### 32. Dados de Efron {-}

::: {.rmdbox latex=1}

Considere $4$ dados não-padrão (*dados de Efron*), cujos lados são rotulados da seguinte forma (cada lado tem a mesma probabilidade):

$$
\begin{aligned}
  A &: 4, 4, 4, 4, 0, 0 \\
  B &: 3, 3, 3, 3, 3, 3 \\
  C &: 6, 6, 2, 2, 2, 2 \\
  D &: 5, 5, 5, 1, 1, 1
\end{aligned}
$$

Cada dado é lançado uma vez. Cada letra representa o resultado do dado correspondente.

a. Ache $P(A > B)$, $P(B > C)$, $P(C > D)$, e $P(D > A)$.

:::

* Eventos equivalentes:

  $$
  \begin{aligned}
    A > B &\iff A = 4 \\
    B > C &\iff C = 2 \\
    C > D &\iff C = 6 \cup (C = 2 \cap D = 1) \\
    D > A & \iff D = 5 \cup (D = 1\cap A = 0)
  \end{aligned}
  $$

* $P(A > B) = 2/3$.

* $P(B > C) = 2/3$.

* $P(C > D) = 1/3 + 2/3 \cdot 1/2 = 2/3$.

* $P(D > A) = 1/2 + 1/2 \cdot 2/3 = 2/3$.

::: {.rmdbox latex=1}

b. O evento $A > B$ é independente de $B > C$?

   O evento $B > C$ é independente de $C > D$?

:::

* Sim: 

  $$
  \begin{aligned}
  P(A > B \cap B > C) &= P(A = 4) \cdot P(C = 2) \\
  &= P(A > B) \cdot P(B > C)
  \end{aligned}
  $$

  Intuitivamente: como o resultado de $B$ não importa para $A > B$ nem para $B > C$, os eventos são independentes.

* Não:

  $$
  \begin{aligned}
    P(B > C \cap C > D) 
    &= P(C = 2 \cap [C = 6 \cup (C = 2 \cap D = 1)]) \\
    &= P((C = 2 \cap C = 6) \cup (C = 2 \cap D = 1)) \\
    &= P(C = 2 \cap D = 1) \\
    &= 2/3 \cdot 1/2 \\
    &= 1/3
  \end{aligned}
  $$

  mas
  
  $$
  P(B > C) \cdot P(C > D) = 4/9
  $$


### 33 {-}


### 35. Xadrez {-}

::: {.rmdbox latex=1}

* Você vai jogar $2$ partidas de xadrez contra um adversário desconhecido. 

* O nível do seu adversário pode ser novato, intermediário, ou avançado, com probabilidades iguais.

* As probabilidades de você vencer uma partida são, dependendo do nível do adversário, respectivamente, $90\%$, $50\%$, e $30\%$.

a. Qual a probabilidade de você vencer a primeira partida?

b. Parabéns, você venceu a primeira partida. Dada esta informação, qual a probabilidade de que você também vença a segunda partida (suponha que, [dado o nível do seu adversário]{.hl}, os resultados das partidas são independentes)?

c. Explique a diferença entre 

   1. supor que os resultados das partidas são independentes, e
   
   2. supor que os resultados das partidas são independentes, dado o nível do seu adversário.
   
   Qual destas suposições parece mais razoável? Por quê?

:::

* Antes de mais nada, vamos definir os eventos:

  $$
  \begin{aligned}
    N &= \text{o adversário é novato} \\
    I &= \text{o adversário é intermediário} \\
    A &= \text{o adversário é avançado} \\
    V_1 &= \text{você vence a primeira partida} \\
    V_2 &= \text{você vence a segunda partida} 
  \end{aligned}
  $$

* O enunciado dá as probabilidades

  $$
  \begin{aligned}
  P(N) &= 1/3 \\
  P(I) &= 1/3 \\
  P(A) &= 1/3 \\
  P(V_1 \mid N) &= 9/10 \\
  P(V_1 \mid I) &= 5/10 \\
  P(V_1 \mid A) &= 3/10
  \end{aligned}
  $$

* Para resolver (a), basta usar probabilidade total, condicionando sobre o nível do adversário:

  $$
  \begin{aligned}
  P(V_1) 
  &= 
  P(V_1 \mid N) \cdot P(N) \;+\;
  P(V_1 \mid I) \cdot P(I) \;+\;
  P(V_1 \mid A) \cdot P(A)
  \\
  &= 
  \frac{9}{10} \cdot \frac{1}{3} + 
  \frac{5}{10} \cdot \frac{1}{3} + 
  \frac{3}{10} \cdot \frac{1}{3} \\
  &= 
  \frac{1}{3} \cdot \left(
  \frac{9}{10} + 
  \frac{5}{10} + 
  \frac{3}{10} \right) \\
  &=
  \frac{17}{30}
  \end{aligned}
  $$

  Faz sentido. Como as probabilidades dos níveis possíveis do adversário são iguais, a probabilidade de vencer é [a média aritmética]{.hl} das probabilidades de vencer contra cada nível.
  
  Se as probabilidades dos níveis do adversário fossem diferentes, seria a [média ponderada.]{.hl}
  
* Para (b), queremos calcular $P(V_2 \mid V_1)$.

  Dizer que $V_1$ e $V_2$ são independentes [dado o nível do adversário]{.hl} é dizer
  
  $$
  P(V_2 \mid V_1, N) = P(V_1 \mid V_2, N) = P(V_2 \mid N) = P(V_1 \mid N)
  $$

  e analogamente para probabilidades condicionadas a $I$ e a $A$.
  
  Ou seja, dado um nível específico do adversário, saber que $V_1$ ocorreu não altera a probabilidade de $V_2$ ocorrer, e vice-versa.
  
  Vamos calcular $P(V_2 \mid V_1)$ usando probabilidade total, condicionando ao nível:
  
  $$
  \begin{aligned}
  \underbrace{P(V_2 \mid V_1, N) \cdot P(N \mid V_1)}_{\text{novato}}
  \;+\;
  \underbrace{P(V_2 \mid V_1, I) \cdot P(I \mid V_1)}_{\text{intermediário}}
  \;+\;
  \underbrace{P(V_2 \mid V_1, A) \cdot P(A \mid V_1)}_{\text{avançado}}
  \end{aligned}
  $$

  Para o lado esquerdo de cada produto, a independência condicional diz que
  
  \begin{alignat*}{3}
  P(V_2 \mid V_1, N) &= P(V_1 \mid N) &= 9/10 \\
  P(V_2 \mid V_1, I) &= P(V_1 \mid I) &= 5/10 \\
  P(V_2 \mid V_1, A) &= P(V_1 \mid A) &= 3/10
  \end{alignat*}

  Para o lado direito de cada produto, usamos Bayes. Todas as probabilidades envolvidas já foram calculadas.
  
  Novato:
  
  $$
  \begin{aligned}
  P(N \mid V_1) 
  &=
  \frac{P(V_1 \mid N) \cdot P(N)}{P(V_1)}
  \\
  &= \frac{9/10 \cdot 1/3}{17/30}
  \\
  &= \frac{9}{17}
  \end{aligned}
  $$

  Intermediário:
  
  $$
  \begin{aligned}
  P(I \mid V_1) 
  &=
  \frac{P(V_1 \mid I) \cdot P(I)}{P(V_1)}
  \\
  &= \frac{5/10 \cdot 1/3}{17/30}
  \\
  &= \frac{5}{17}
  \end{aligned}
  $$
  
  Avançado:
  
  $$
  \begin{aligned}
  P(A \mid V_1) 
  &=
  \frac{P(V_1 \mid A) \cdot P(A)}{P(V_1)}
  \\
  &= \frac{3/10 \cdot 1/3}{17/30}
  \\
  &= \frac{3}{17}
  \end{aligned}
  $$

  A resposta final é
  
  $$
  \frac{9}{10} \cdot \frac{9}{17} \;+\;
  \frac{5}{10} \cdot \frac{5}{17} \;+\;
  \frac{3}{10} \cdot \frac{3}{17}
  \;=\;
  \frac{`r (81 + 25 + 9)/5`}{`r 170/5`}
  $$

* Para responder (c):

  Dizer que $V_1$ e $V_2$ são [incondicionalmente]{.hl} independentes seria dizer que 
  
  $$
  P(V_2 \mid V_1) = P(V_2)
  $$

  Ainda mais, como o nível do adversário não muda de uma partida para outra, teríamos também 
  
  $$
  P(V_2) = P(V_1)
  $$

  Ou seja, cada partida seria uma prova de Bernoulli com a mesma probabilidade de sucesso.
  
  Considerando independência [condicional]{.hl}, saber que vencemos a primeira partida nos dá informação sobre o nível do adversário, e esta informação é considerada para calcular a probabilidade de vencer a segunda partida.
  
  De fato, usando independência condicional, temos
  
  $$
  P(V_1) \approx `r 17/30`
  $$
  
  e
  
  $$
  P(V_2 \mid V_1) \approx `r 23/34`
  $$
  

### 36. [Paradoxo de Berkson](https://en.wikipedia.org/wiki/Berkson%27s_paradox) {-}

::: {.rmdbox latex=1}

[Se]{.hl} 

* $A$ e $B$ são independentes, e

* $P(A \cap B) > 0$, e

* $P(A \cup B) < 1$, e

* $C = A \cup B$

[então]{.hl} $A$ e $B$ são condicionalmente dependentes, dado $C$, com

$$
P(A \mid B, C) < P(A \mid C)
$$

Exemplo: universidade admite candidatos que são bons jogadores de basquete ($A$) ou que são bons em Matemática ($B$). 

:::

* De $P(A \cap B) > 0$, temos que $P(A) > 0$ e que $P(B) > 0$.

* Daí, $P(C) = P(A \cup B) > 0$.

* Para o lado esquerdo:

  $$
  \begin{aligned}
  P(A \mid B, C) 
  &= \frac{P(A \cap B \cap C)}{P(B \cap C)} \\
  &= \frac{P(A \cap B)}{P(B)} \\
  &= \frac{P(A)P(B)}{P(B)} \\
  &= P(A)
  \end{aligned}
  $$

* Para o lado direito:

  $$
  \begin{aligned}
  P(A \mid C) 
  &= \frac{P(A \cap C)}{P(C)} \\
  &= \frac{P(A)}{P(C)} \\
  &= \frac{P(A)}{P(A \cup B)} 
  \end{aligned}
  $$

* Como o denominador $P(A \cup B) < 1$, esta probabilidade é maior do que $P(A)$.


### 37 {-}



### 38 {-}

