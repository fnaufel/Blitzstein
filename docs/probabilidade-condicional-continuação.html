<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>05: Probabilidade condicional (continuação) | Introduction to Probability (Joe Blitzstein)</title>
<meta name="author" content="Fernando Náufel">
<meta name="description" content="Vídeo   Exercícios do livro (cap. 2)  30. Filho mais velho  Uma família tem \(3\) filhos: \(A\), \(B\) e \(C\). O evento “\(A\) é mais velho que \(B\)” é independente de “\(A\) é mais velho que...">
<meta name="generator" content="bookdown 0.25 with bs4_book()">
<meta property="og:title" content="05: Probabilidade condicional (continuação) | Introduction to Probability (Joe Blitzstein)">
<meta property="og:type" content="book">
<meta property="og:description" content="Vídeo   Exercícios do livro (cap. 2)  30. Filho mais velho  Uma família tem \(3\) filhos: \(A\), \(B\) e \(C\). O evento “\(A\) é mais velho que \(B\)” é independente de “\(A\) é mais velho que...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="05: Probabilidade condicional (continuação) | Introduction to Probability (Joe Blitzstein)">
<meta name="twitter:description" content="Vídeo   Exercícios do livro (cap. 2)  30. Filho mais velho  Uma família tem \(3\) filhos: \(A\), \(B\) e \(C\). O evento “\(A\) é mais velho que \(B\)” é independente de “\(A\) é mais velho que...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/_Lexend-0.4.0/font.css" rel="stylesheet">
<link href="libs/_JetBrains%20Mono-0.4.0/font.css" rel="stylesheet">
<link href="libs/_Roboto-0.4.0/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="html_files/alterar_detalhes.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="html_files/styles_all.css">
<link rel="stylesheet" href="html_files/styles_book.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Ir para conteúdo principal</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Introduction to Probability (Joe Blitzstein)</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Mostrar sumário</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Buscar" aria-label="Buscar">
</form>

      <nav aria-label="Conteúdo"><h2>Conteúdo</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Apresentação</a></li>
<li><a class="" href="probabilidade-e-contagem.html">01: Probabilidade e contagem</a></li>
<li><a class="" href="hist%C3%B3rias-e-axiomas.html">02: Histórias e axiomas</a></li>
<li><a class="" href="problema-do-anivers%C3%A1rio-propriedades.html">03: Problema do aniversário, propriedades</a></li>
<li><a class="" href="probabilidade-condicional.html">04: Probabilidade condicional</a></li>
<li><a class="active" href="probabilidade-condicional-continua%C3%A7%C3%A3o.html">05: Probabilidade condicional (continuação)</a></li>
<li><a class="" href="refer%C3%AAncias.html">Referências</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/fnaufel/???????">Ver código-fonte do livro <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="probabilidade-condicional-continuação" class="section level1 unnumbered">
<h1>05: Probabilidade condicional (continuação)<a class="anchor" aria-label="anchor" href="#probabilidade-condicional-continua%C3%A7%C3%A3o"><i class="fas fa-link"></i></a>
</h1>
<div id="vídeo-4" class="section level2 unnumbered">
<h2>Vídeo<a class="anchor" aria-label="anchor" href="#v%C3%ADdeo-4"><i class="fas fa-link"></i></a>
</h2>
<iframe src="https://www.youtube.com/embed/JzDvVgNDxo8" width="100%" height="400px" data-external="1" class="center" style="width: 80%;">
</iframe>
</div>
<div id="exercícios-do-livro-cap.-2-1" class="section level2 unnumbered">
<h2>Exercícios do livro (cap. 2)<a class="anchor" aria-label="anchor" href="#exerc%C3%ADcios-do-livro-cap.-2-1"><i class="fas fa-link"></i></a>
</h2>
<div id="filho-mais-velho" class="section level3 unnumbered">
<h3>30. Filho mais velho<a class="anchor" aria-label="anchor" href="#filho-mais-velho"><i class="fas fa-link"></i></a>
</h3>
<div class="rmdbox">
<p>Uma família tem <span class="math inline">\(3\)</span> filhos: <span class="math inline">\(A\)</span>, <span class="math inline">\(B\)</span> e <span class="math inline">\(C\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>O evento “<span class="math inline">\(A\)</span> é mais velho que <span class="math inline">\(B\)</span>” é independente de “<span class="math inline">\(A\)</span> é mais velho que <span class="math inline">\(C\)</span>”?</li>
</ol>
</div>
<ul>
<li>
<p>Intuitivamente:</p>
<p>Não, pois <span class="math inline">\(A\)</span> ser mais velho que <span class="math inline">\(B\)</span> torna mais provável que <span class="math inline">\(A\)</span> seja mais velho que <span class="math inline">\(C\)</span>.</p>
</li>
</ul>
<div class="rmdbox">
<ol start="2" style="list-style-type: lower-alpha">
<li>Qual a probabilidade de que <span class="math inline">\(A\)</span> é mais velho que <span class="math inline">\(B\)</span>, dado que <span class="math inline">\(A\)</span> é mais velho que <span class="math inline">\(C\)</span>?</li>
</ol>
</div>
<ul>
<li><p>Queremos achar <span class="math inline">\(P(A &gt; B \mid A &gt; C)\)</span>.</p></li>
<li>
<p>Esta probabilidade é igual a</p>
<p><span class="math display">\[
\frac{P(A &gt; B,  A &gt; C)}{P(A &gt; C)}
\]</span></p>
</li>
<li><p>O numerador é a probabilidade de <span class="math inline">\(A\)</span> ser o mais velho.</p></li>
<li>
<p>Se todas as <span class="math inline">\(6\)</span> ordens de nascimento tiverem a mesma probabilidade,</p>
<p><span class="math display">\[
P(A &gt; B,  A &gt; C) = 2/6 = 1/3
\]</span></p>
</li>
<li>
<p>O denominador é</p>
<p><span class="math display">\[
P(A &gt; C) = 3/6 = 1/2
\]</span></p>
</li>
<li><p>Daí, <span class="math inline">\(P(A &gt; B \mid A &gt; C) = \frac{1/3}{1/2} = \frac23\)</span>.</p></li>
<li><p>De fato, a probabilidade <span class="hl">condicional</span> <span class="math inline">\(P(A &gt; B \mid A &gt; C) = 2/3\)</span> é <span class="hl">maior</span> do que a probabilidade <span class="hl">não-condicional</span> <span class="math inline">\(P(A &gt; B) = 1/2\)</span>.</p></li>
</ul>
</div>
<div id="auto-independência" class="section level3 unnumbered">
<h3>31. Auto-independência?<a class="anchor" aria-label="anchor" href="#auto-independ%C3%AAncia"><i class="fas fa-link"></i></a>
</h3>
<div class="rmdbox">
<p>Um evento pode ser independente de si mesmo?</p>
</div>
<ul>
<li>
<p>Chamando este evento de <span class="math inline">\(A\)</span>, é preciso que</p>
<p><span class="math display">\[
P(A \cap A) = P(A) = P(A) \cdot P(A)
\]</span></p>
</li>
<li><p>Isto só é possível se <span class="math inline">\(P(A) = 0\)</span> ou se <span class="math inline">\(P(A) = 1\)</span>.</p></li>
</ul>
</div>
<div id="dados-de-efron" class="section level3 unnumbered">
<h3>32. Dados de Efron<a class="anchor" aria-label="anchor" href="#dados-de-efron"><i class="fas fa-link"></i></a>
</h3>
<div class="rmdbox">
<p>Considere <span class="math inline">\(4\)</span> dados não-padrão (<em>dados de Efron</em>), cujos lados são rotulados da seguinte forma (cada lado tem a mesma probabilidade):</p>
<p><span class="math display">\[
\begin{aligned}
  A &amp;: 4, 4, 4, 4, 0, 0 \\
  B &amp;: 3, 3, 3, 3, 3, 3 \\
  C &amp;: 6, 6, 2, 2, 2, 2 \\
  D &amp;: 5, 5, 5, 1, 1, 1
\end{aligned}
\]</span></p>
<p>Cada dado é lançado uma vez. Cada letra representa o resultado do dado correspondente.</p>
<ol style="list-style-type: lower-alpha">
<li>Ache <span class="math inline">\(P(A &gt; B)\)</span>, <span class="math inline">\(P(B &gt; C)\)</span>, <span class="math inline">\(P(C &gt; D)\)</span>, e <span class="math inline">\(P(D &gt; A)\)</span>.</li>
</ol>
</div>
<ul>
<li>
<p>Eventos equivalentes:</p>
<p><span class="math display">\[
\begin{aligned}
  A &gt; B &amp;\iff A = 4 \\
  B &gt; C &amp;\iff C = 2 \\
  C &gt; D &amp;\iff C = 6 \cup (C = 2 \cap D = 1) \\
  D &gt; A &amp; \iff D = 5 \cup (D = 1\cap A = 0)
\end{aligned}
\]</span></p>
</li>
<li><p><span class="math inline">\(P(A &gt; B) = 2/3\)</span>.</p></li>
<li><p><span class="math inline">\(P(B &gt; C) = 2/3\)</span>.</p></li>
<li><p><span class="math inline">\(P(C &gt; D) = 1/3 + 2/3 \cdot 1/2 = 2/3\)</span>.</p></li>
<li><p><span class="math inline">\(P(D &gt; A) = 1/2 + 1/2 \cdot 2/3 = 2/3\)</span>.</p></li>
</ul>
<div class="rmdbox">
<ol start="2" style="list-style-type: lower-alpha">
<li>
<p>O evento <span class="math inline">\(A &gt; B\)</span> é independente de <span class="math inline">\(B &gt; C\)</span>?</p>
<p>O evento <span class="math inline">\(B &gt; C\)</span> é independente de <span class="math inline">\(C &gt; D\)</span>?</p>
</li>
</ol>
</div>
<ul>
<li>
<p>Sim:</p>
<p><span class="math display">\[
\begin{aligned}
P(A &gt; B \cap B &gt; C) &amp;= P(A = 4) \cdot P(C = 2) \\
&amp;= P(A &gt; B) \cdot P(B &gt; C)
\end{aligned}
\]</span></p>
<p>Intuitivamente: como o resultado de <span class="math inline">\(B\)</span> não importa para <span class="math inline">\(A &gt; B\)</span> nem para <span class="math inline">\(B &gt; C\)</span>, os eventos são independentes.</p>
</li>
<li>
<p>Não:</p>
<p><span class="math display">\[
\begin{aligned}
  P(B &gt; C \cap C &gt; D)
  &amp;= P(C = 2 \cap [C = 6 \cup (C = 2 \cap D = 1)]) \\
  &amp;= P((C = 2 \cap C = 6) \cup (C = 2 \cap D = 1)) \\
  &amp;= P(C = 2 \cap D = 1) \\
  &amp;= 2/3 \cdot 1/2 \\
  &amp;= 1/3
\end{aligned}
\]</span></p>
<p>mas</p>
<p><span class="math display">\[
P(B &gt; C) \cdot P(C &gt; D) = 4/9
\]</span></p>
</li>
</ul>
</div>
<div id="amigos" class="section level3 unnumbered">
<h3>33. Amigos de Alice e Bob<a class="anchor" aria-label="anchor" href="#amigos"><i class="fas fa-link"></i></a>
</h3>
<div class="rmdbox">
<ul>
<li><p>Alice, Bob, e mais <span class="math inline">\(100\)</span> pessoas vivem em uma cidade.</p></li>
<li><p><span class="math inline">\(C\)</span> é o conjunto das outras <span class="math inline">\(100\)</span> pessoas.</p></li>
<li><p><span class="math inline">\(A \subseteq C\)</span> é o conjunto de amigos de Alice.</p></li>
<li><p><span class="math inline">\(B \subseteq C\)</span> é o conjunto de amigos de Bob.</p></li>
<li><p>Para cada pessoa em <span class="math inline">\(C\)</span>, a probabilidade de Alice ser amiga da pessoa é <span class="math inline">\(1/2\)</span>.</p></li>
<li><p>Idem para Bob.</p></li>
<li><p>As amizades são independentes.</p></li>
</ul>
</div>
<div class="rmdbox">
<ol style="list-style-type: lower-alpha">
<li>Seja <span class="math inline">\(D \subseteq C\)</span>. Achar <span class="math inline">\(P(A = D)\)</span>.</li>
</ol>
</div>
<ul>
<li>
<p>Para cada <span class="math inline">\(x \in C\)</span>:</p>
<ol style="list-style-type: decimal">
<li>
<p><span class="math inline">\(x \in A \land x \in D\)</span>, com probabilidade <span class="math inline">\(\frac12 \cdot \frac{|D|}{|C|}\)</span>,</p>
<p>ou (exclusivo)</p>
</li>
<li><p><span class="math inline">\(x \not\in A \land x \not\in D\)</span>, com probabilidade <span class="math inline">\(\frac12 \cdot \left(1 - \frac{|D|}{|C|}\right)\)</span></p></li>
</ol>
</li>
<li>
<p>Somando as probabilidades dos casos, para cada <span class="math inline">\(x \in C\)</span>, a probabilidade de <span class="math inline">\(x\)</span> estar em <span class="math inline">\(A\)</span> e em <span class="math inline">\(D\)</span>, ou de <span class="math inline">\(x\)</span> não estar nem em <span class="math inline">\(A\)</span>, nem em <span class="math inline">\(D\)</span>, é</p>
<p><span class="math display">\[
\frac12 \cdot \frac{|D|}{|C|} + \frac12 \cdot \left(1 - \frac{|D|}{|C|}\right) = \frac12
\]</span></p>
</li>
<li>
<p>A probabilidade de <span class="math inline">\(A = D\)</span> é a probabilidade de, para todo <span class="math inline">\(x \in C\)</span>, acontecer de <span class="math inline">\(x \in A \land x \in D\)</span> ou <span class="math inline">\(x \in A \land x \in D\)</span>. Como os eventos são independentes, temos</p>
<p><span class="math display">\[
P(A = D) = \frac1{2^{|C|}}
\]</span></p>
</li>
<li>
<p>Vamos simular a situação. Estamos supondo que os elementos de <span class="math inline">\(D\)</span> são escolhidos segundo uma amostragem simples uniforme, sem reposição. <a href="probabilidade-condicional-continua%C3%A7%C3%A3o.html#amostra">Veja explicações mais detalhadas abaixo</a>.</p>
<div class="sourceCode" id="simular-amigos"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">simular</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span>, <span class="va">n</span><span class="op">)</span> <span class="op">{</span>

  <span class="va">A</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="va">p</span><span class="op">]</span>
  <span class="va">D</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">]</span>

  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">A</span><span class="op">)</span> <span class="op">!=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">D</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
    <span class="cn">FALSE</span>
  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/all.html">all</a></span><span class="op">(</span><span class="va">A</span> <span class="op">==</span> <span class="va">D</span><span class="op">)</span>
  <span class="op">}</span>

<span class="op">}</span></code></pre></div>
</li>
<li>
<p>Para as probabilidades não ficarem tão pequenas, vamos usar um universo <span class="math inline">\(C\)</span> com <span class="math inline">\(10\)</span> elementos apenas:</p>
<div class="sourceCode" id="simular-com-p"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>
<span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10</span>
<span class="va">nsims</span> <span class="op">&lt;-</span> <span class="fl">1e6</span>

<span class="va">resultado</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span>
  <span class="fl">1</span><span class="op">:</span><span class="va">nsims</span> <span class="op">%&gt;%</span> 
    <span class="fu">map_lgl</span><span class="op">(</span><span class="op">~</span><span class="fu">simular</span><span class="op">(</span><span class="va">p</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">'P(A = D) simulado = '</span>, <span class="va">resultado</span><span class="op">)</span></code></pre></div>
<pre><code>## P(A = D) simulado =  0,000981</code></pre>
<div class="sourceCode" id="simular-com-p"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">'P(A = D) teórico  = '</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">^</span><span class="va">n</span><span class="op">)</span></code></pre></div>
<pre><code>## P(A = D) teórico  =  0,0009765625</code></pre>
</li>
<li><p>E se <span class="math inline">\(p \neq 1/2\)</span>?</p></li>
<li><p><a href="probabilidade-condicional-continua%C3%A7%C3%A3o.html#amostra">Como explicado abaixo</a>, a probabilidade de um <span class="math inline">\(x \in C\)</span> pertencer a <span class="math inline">\(D\)</span> (supondo que <span class="math inline">\(D\)</span> é obtido por amostragem simples) é <span class="math inline">\(1/2\)</span>.</p></li>
<li>
<p>Então, Para cada <span class="math inline">\(x \in C\)</span>:</p>
<ol style="list-style-type: decimal">
<li>
<p><span class="math inline">\(x \in A \land x \in D\)</span>, com probabilidade <span class="math inline">\(p/2\)</span>,</p>
<p>ou (exclusivo)</p>
</li>
<li><p><span class="math inline">\(x \not\in A \land x \not\in D\)</span>, com probabilidade <span class="math inline">\((1 - p)/2\)</span></p></li>
</ol>
</li>
<li><p>Somando as probabilidades dos casos, para cada <span class="math inline">\(x \in C\)</span>, a probabilidade de <span class="math inline">\(x\)</span> estar em <span class="math inline">\(A\)</span> e em <span class="math inline">\(D\)</span>, ou de <span class="math inline">\(x\)</span> não estar nem em <span class="math inline">\(A\)</span>, nem em <span class="math inline">\(D\)</span>, é, de novo, <span class="math inline">\(1/2\)</span>.</p></li>
<li><p>Logo, <span class="math inline">\(P(A = D) = 1/ 2^{|C|}\)</span> novamente.</p></li>
<li><p>Ou seja, <span class="hl">o resultado vale para qualquer valor de <span class="math inline">\(p\)</span>.</span> Altere o valor de <span class="math inline">\(p\)</span> no <a href="probabilidade-condicional-continua%C3%A7%C3%A3o.html#simular-com-p">código da simulação acima</a> para verificar.</p></li>
</ul>
<div class="rmdbox">
<ol start="2" style="list-style-type: lower-alpha">
<li>Achar <span class="math inline">\(P(A \subseteq B)\)</span>
</li>
</ol>
</div>
<ul>
<li><p>Para cada <span class="math inline">\(x \in A\)</span>, a probabilidade de <span class="math inline">\(x \in B\)</span> é <span class="math inline">\(1/2\)</span>.</p></li>
<li><p>Logo, <span class="math inline">\(P(A \subseteq B) = 1 / 2^{|A|}\)</span>.</p></li>
</ul>
<div class="rmdbox">
<ol start="3" style="list-style-type: lower-alpha">
<li>Achar <span class="math inline">\(P(A \cup B) = C\)</span>.</li>
</ol>
</div>
<ul>
<li>
<p>Para cada <span class="math inline">\(x \in C\)</span>,</p>
<p><span class="math display">\[
\begin{aligned}
P(x \in A \cup B)
&amp;= P(x \in A) + P(x \in B) - P(x \in A \cap B) \\
&amp;= 1/2 + 1/2 - 1/4 \\
&amp;= 3/4
\end{aligned}
\]</span></p>
</li>
<li><p>Logo, <span class="math inline">\(P(A \cup B = C) = (3/4)^{|C|}\)</span></p></li>
</ul>
</div>
<div id="amostra" class="section level3 unnumbered">
<h3>Extra: amostragem simples<a class="anchor" aria-label="anchor" href="#amostra"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>
<p><a href="probabilidade-condicional-continua%C3%A7%C3%A3o.html#amigos">Na resolução acima</a>, usamos a igualdade</p>
<p><span class="math display">\[
P(x \in D) = \frac{|D|}{n}
\]</span></p>
<p>para representar a probabilidade de que um elemento qualquer de um universo com <span class="math inline">\(n\)</span> elementos pertença a um <span class="hl">conjunto <span class="math inline">\(D\)</span> fixo</span>.</p>
</li>
<li><p>Mas e quando não sabemos qual é o conjunto <span class="math inline">\(D\)</span>, nem qual o seu tamanho?</p></li>
<li><p>Neste caso, precisamos supor algo sobre a distribuição dos subconjuntos.</p></li>
<li><p>O mais comum é supor que <span class="hl">cada um dos <span class="math inline">\(2^n\)</span> subconjuntos tem a mesma probabilidade de ser o resultado da amostragem.</span></p></li>
<li><p>Com esta suposição, como calculamos <span class="math inline">\(P(x \in D)\)</span>?</p></li>
<li>
<p>Vamos condicionar ao tamanho do conjunto <span class="math inline">\(D\)</span> e marginalizar:</p>
<p><span class="math display">\[
P(x \in D) = \sum_{k = 0}^{n} P(x \in D \mid |D| = k) \cdot P(|D| = k)
\]</span></p>
</li>
<li>
<p>Calculando a primeira probabilidade dentro do somatório:</p>
<p><span class="math display">\[
\begin{aligned}
P(x \in D \mid |D| = k)
&amp;= \frac{\binom{n - 1}{k - 1}}{\binom n k} \\
&amp;= \frac k n
\end{aligned}
\]</span></p>
<p>Na primeira linha, o numerador é a quantidade de subconjuntos de <span class="math inline">\(k\)</span> elementos que contêm <span class="math inline">\(x\)</span> (basta escolher os outros <span class="math inline">\(k - 1\)</span> elementos dentre os <span class="math inline">\(n - 1\)</span> outros elementos do universo); o denominador é o total de subconjuntos de <span class="math inline">\(k\)</span> elementos.</p>
<p>Perceba que <span class="hl">aqui usamos a suposição de que todos os subconjuntos têm a mesma probabilidade de ser amostrados</span>.</p>
<p>Perceba também que, como antes, esta probabilidade é igual a <span class="math inline">\(\frac{|D|}{n}\)</span>.</p>
</li>
<li>
<p>Calculando a segunda probabilidade dentro do somatório:</p>
<p><span class="math display">\[
\begin{aligned}
P(|D| = k)
&amp;= \frac{\binom{n}{k}}{2^n}
\end{aligned}
\]</span></p>
<p>De novo, usando a suposição de que todos os subconjuntos são equiprováveis, temos a quantidade de subconjuntos de <span class="math inline">\(k\)</span> elementos sobre o total de subconjuntos.</p>
</li>
<li>
<p>Juntando tudo:</p>
<p><span class="math display">\[
\begin{aligned}
P(x \in D)
&amp;= \sum_{k = 0}^{n} P(x \in D \mid |D| = k) \cdot P(|D| = k) \\
&amp;= \sum_{k = 0}^{n} \frac 1 {2^n} \binom n k \frac k n \\
&amp;= \frac 1 {2^n} \sum_{k = 0}^{n} \binom{n - 1}{k - 1} \\
&amp;= \frac 1 {2^n} \cdot 2^{n - 1} \\
&amp;= \frac 1 2
\end{aligned}
\]</span></p>
<div class="rmdimportant">
<p>Fazer amostragem uniforme significa que todos os subconjuntos são equiprováveis, <span class="hl">ou, equivalentemente, que cada elemento do universo tem <span class="math inline">\(50\%\)</span> de chance de estar na amostra.</span></p>
</div>
</li>
<li>
<p>Por isso, <a href="probabilidade-condicional-continua%C3%A7%C3%A3o.html#simular-amigos">na simulação</a>, geramos o conjunto <span class="math inline">\(D\)</span> com o comando</p>
<p><code>D &lt;- (1:n)[runif(n) &lt;= 1/2]</code></p>
</li>
</ul>
</div>
<div id="xadrez" class="section level3 unnumbered">
<h3>35. Xadrez<a class="anchor" aria-label="anchor" href="#xadrez"><i class="fas fa-link"></i></a>
</h3>
<div class="rmdbox">
<ul>
<li><p>Você vai jogar <span class="math inline">\(2\)</span> partidas de xadrez contra um adversário desconhecido.</p></li>
<li><p>O nível do seu adversário pode ser novato, intermediário, ou avançado, com probabilidades iguais.</p></li>
<li><p>As probabilidades de você vencer uma partida são, dependendo do nível do adversário, respectivamente, <span class="math inline">\(90\%\)</span>, <span class="math inline">\(50\%\)</span>, e <span class="math inline">\(30\%\)</span>.</p></li>
</ul>
<ol style="list-style-type: lower-alpha">
<li><p>Qual a probabilidade de você vencer a primeira partida?</p></li>
<li><p>Parabéns, você venceu a primeira partida. Dada esta informação, qual a probabilidade de que você também vença a segunda partida (suponha que, <span class="hl">dado o nível do seu adversário</span>, os resultados das partidas são independentes)?</p></li>
<li>
<p>Explique a diferença entre</p>
<ol style="list-style-type: decimal">
<li><p>supor que os resultados das partidas são independentes, e</p></li>
<li><p>supor que os resultados das partidas são independentes, dado o nível do seu adversário.</p></li>
</ol>
<p>Qual destas suposições parece mais razoável? Por quê?</p>
</li>
</ol>
</div>
<ul>
<li>
<p>Antes de mais nada, vamos definir os eventos:</p>
<p><span class="math display">\[
\begin{aligned}
  N &amp;= \text{o adversário é novato} \\
  I &amp;= \text{o adversário é intermediário} \\
  A &amp;= \text{o adversário é avançado} \\
  V_1 &amp;= \text{você vence a primeira partida} \\
  V_2 &amp;= \text{você vence a segunda partida}
\end{aligned}
\]</span></p>
</li>
<li>
<p>O enunciado dá as probabilidades</p>
<p><span class="math display">\[
\begin{aligned}
P(N) &amp;= 1/3 \\
P(I) &amp;= 1/3 \\
P(A) &amp;= 1/3 \\
P(V_1 \mid N) &amp;= 9/10 \\
P(V_1 \mid I) &amp;= 5/10 \\
P(V_1 \mid A) &amp;= 3/10
\end{aligned}
\]</span></p>
</li>
<li>
<p>Para resolver (a), basta usar probabilidade total, condicionando sobre o nível do adversário:</p>
<p><span class="math display">\[
\begin{aligned}
P(V_1)
&amp;=
P(V_1 \mid N) \cdot P(N) \;+\;
P(V_1 \mid I) \cdot P(I) \;+\;
P(V_1 \mid A) \cdot P(A)
\\
&amp;=
\frac{9}{10} \cdot \frac{1}{3} +
\frac{5}{10} \cdot \frac{1}{3} +
\frac{3}{10} \cdot \frac{1}{3} \\
&amp;=
\frac{1}{3} \cdot \left(
\frac{9}{10} +
\frac{5}{10} +
\frac{3}{10} \right) \\
&amp;=
\frac{17}{30}
\end{aligned}
\]</span></p>
<p>Faz sentido. Como as probabilidades dos níveis possíveis do adversário são iguais, a probabilidade de vencer é <span class="hl">a média aritmética</span> das probabilidades de vencer contra cada nível.</p>
<p>Se as probabilidades dos níveis do adversário fossem diferentes, seria a <span class="hl">média ponderada.</span></p>
</li>
<li>
<p>Para (b), queremos calcular <span class="math inline">\(P(V_2 \mid V_1)\)</span>.</p>
<p>Dizer que <span class="math inline">\(V_1\)</span> e <span class="math inline">\(V_2\)</span> são independentes <span class="hl">dado o nível do adversário</span> é dizer</p>
<p><span class="math display">\[
P(V_2 \mid V_1, N) = P(V_1 \mid V_2, N) = P(V_2 \mid N) = P(V_1 \mid N)
\]</span></p>
<p>e analogamente para probabilidades condicionadas a <span class="math inline">\(I\)</span> e a <span class="math inline">\(A\)</span>.</p>
<p>Ou seja, dado um nível específico do adversário, saber que <span class="math inline">\(V_1\)</span> ocorreu não altera a probabilidade de <span class="math inline">\(V_2\)</span> ocorrer, e vice-versa.</p>
<p>Vamos calcular <span class="math inline">\(P(V_2 \mid V_1)\)</span> usando probabilidade total, condicionando ao nível:</p>
<p><span class="math display">\[
\begin{aligned}
\underbrace{P(V_2 \mid V_1, N) \cdot P(N \mid V_1)}_{\text{novato}}
\;+\;
\underbrace{P(V_2 \mid V_1, I) \cdot P(I \mid V_1)}_{\text{intermediário}}
\;+\;
\underbrace{P(V_2 \mid V_1, A) \cdot P(A \mid V_1)}_{\text{avançado}}
\end{aligned}
\]</span></p>
<p>Para o lado esquerdo de cada produto, a independência condicional diz que</p>
<p><span class="math display">\[\begin{alignat*}{3}
P(V_2 \mid V_1, N) &amp;= P(V_1 \mid N) &amp;= 9/10 \\
P(V_2 \mid V_1, I) &amp;= P(V_1 \mid I) &amp;= 5/10 \\
P(V_2 \mid V_1, A) &amp;= P(V_1 \mid A) &amp;= 3/10
\end{alignat*}\]</span></p>
<p>Para o lado direito de cada produto, usamos Bayes. Todas as probabilidades envolvidas já foram calculadas.</p>
<p>Novato:</p>
<p><span class="math display">\[
\begin{aligned}
P(N \mid V_1)
&amp;=
\frac{P(V_1 \mid N) \cdot P(N)}{P(V_1)}
\\
&amp;= \frac{9/10 \cdot 1/3}{17/30}
\\
&amp;= \frac{9}{17}
\end{aligned}
\]</span></p>
<p>Intermediário:</p>
<p><span class="math display">\[
\begin{aligned}
P(I \mid V_1)
&amp;=
\frac{P(V_1 \mid I) \cdot P(I)}{P(V_1)}
\\
&amp;= \frac{5/10 \cdot 1/3}{17/30}
\\
&amp;= \frac{5}{17}
\end{aligned}
\]</span></p>
<p>Avançado:</p>
<p><span class="math display">\[
\begin{aligned}
P(A \mid V_1)
&amp;=
\frac{P(V_1 \mid A) \cdot P(A)}{P(V_1)}
\\
&amp;= \frac{3/10 \cdot 1/3}{17/30}
\\
&amp;= \frac{3}{17}
\end{aligned}
\]</span></p>
<p>A resposta final é</p>
<p><span class="math display">\[
\frac{9}{10} \cdot \frac{9}{17} \;+\;
\frac{5}{10} \cdot \frac{5}{17} \;+\;
\frac{3}{10} \cdot \frac{3}{17}
\;=\;
\frac{23}{34}
\]</span></p>
</li>
<li>
<p>Para responder (c):</p>
<p>Dizer que <span class="math inline">\(V_1\)</span> e <span class="math inline">\(V_2\)</span> são <span class="hl">incondicionalmente</span> independentes seria dizer que</p>
<p><span class="math display">\[
P(V_2 \mid V_1) = P(V_2)
\]</span></p>
<p>Ainda mais, como o nível do adversário não muda de uma partida para outra, teríamos também</p>
<p><span class="math display">\[
P(V_2) = P(V_1)
\]</span></p>
<p>Ou seja, cada partida seria uma prova de Bernoulli com a mesma probabilidade de sucesso.</p>
<p>Considerando independência <span class="hl">condicional</span>, saber que vencemos a primeira partida nos dá informação sobre o nível do adversário, e esta informação é considerada para calcular a probabilidade de vencer a segunda partida.</p>
<p>De fato, usando independência condicional, temos</p>
<p><span class="math display">\[
P(V_1) \approx 0{,}57
\]</span></p>
<p>e</p>
<p><span class="math display">\[
P(V_2 \mid V_1) \approx 0{,}68
\]</span></p>
</li>
</ul>
</div>
<div id="paradoxo-de-berkson" class="section level3 unnumbered">
<h3>36. <a href="https://en.wikipedia.org/wiki/Berkson%27s_paradox">Paradoxo de Berkson</a><a class="anchor" aria-label="anchor" href="#paradoxo-de-berkson"><i class="fas fa-link"></i></a>
</h3>
<div class="rmdbox">
<p><span class="hl">Se</span></p>
<ul>
<li><p><span class="math inline">\(A\)</span> e <span class="math inline">\(B\)</span> são independentes, e</p></li>
<li><p><span class="math inline">\(P(A \cap B) &gt; 0\)</span>, e</p></li>
<li><p><span class="math inline">\(P(A \cup B) &lt; 1\)</span>, e</p></li>
<li><p><span class="math inline">\(C = A \cup B\)</span></p></li>
</ul>
<p><span class="hl">então</span> <span class="math inline">\(A\)</span> e <span class="math inline">\(B\)</span> são condicionalmente dependentes, dado <span class="math inline">\(C\)</span>, com</p>
<p><span class="math display">\[
P(A \mid B, C) &lt; P(A \mid C)
\]</span></p>
<p>Exemplo: universidade admite candidatos que são bons jogadores de basquete (<span class="math inline">\(A\)</span>) ou que são bons em Matemática (<span class="math inline">\(B\)</span>) — <span class="hl">supondo que estes são eventos independentes, o que é meio duvidoso</span>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Na verdade, em vez de independência entre &lt;span class="math inline"&gt;\(A\)&lt;/span&gt; e &lt;span class="math inline"&gt;\(B\)&lt;/span&gt;, basta que um evento atrapalhe o outro para termos o paradoxo. Em termos da &lt;a href="probabilidade-condicional.html#i"&gt;nossa medida de independência &lt;span class="math inline"&gt;\(I\)&lt;/span&gt;&lt;/a&gt;, basta &lt;span class="math inline"&gt;\(0&amp;lt; I &amp;lt; 1\)&lt;/span&gt;.&lt;/p&gt;'><sup>5</sup></a></p>
</div>
<ul>
<li><p>De <span class="math inline">\(P(A \cap B) &gt; 0\)</span>, temos que <span class="math inline">\(P(A) &gt; 0\)</span> e que <span class="math inline">\(P(B) &gt; 0\)</span>.</p></li>
<li><p>Daí, <span class="math inline">\(P(C) = P(A \cup B) &gt; 0\)</span>.</p></li>
<li>
<p>Para o lado esquerdo:</p>
<p><span class="math display">\[
\begin{aligned}
P(A \mid B, C)
&amp;= \frac{P(A \cap B \cap C)}{P(B \cap C)} \\
&amp;= \frac{P(A \cap B)}{P(B)} \\
&amp;= \frac{P(A)P(B)}{P(B)} \\
&amp;= P(A)
\end{aligned}
\]</span></p>
</li>
<li>
<p>Para o lado direito:</p>
<p><span class="math display">\[
\begin{aligned}
P(A \mid C)
&amp;= \frac{P(A \cap C)}{P(C)} \\
&amp;= \frac{P(A)}{P(C)} \\
&amp;= \frac{P(A)}{P(A \cup B)}
\end{aligned}
\]</span></p>
</li>
<li><p>Como o denominador <span class="math inline">\(P(A \cup B) &lt; 1\)</span>, esta probabilidade é maior do que <span class="math inline">\(P(A)\)</span>.</p></li>
</ul>
</div>
<div id="doenças-e-sintoma" class="section level3 unnumbered">
<h3>37. Doenças e sintoma<a class="anchor" aria-label="anchor" href="#doen%C3%A7as-e-sintoma"><i class="fas fa-link"></i></a>
</h3>
<div class="rmdbox">
<ul>
<li><p>Quem tem a doença <span class="math inline">\(D_1\)</span> ou a doença <span class="math inline">\(D_2\)</span> (ou ambas) tem o sintoma estranho <span class="math inline">\(W\)</span>.</p></li>
<li><p><span class="math inline">\(D_1\)</span> e <span class="math inline">\(D_2\)</span> são independentes, com <span class="math inline">\(P(D_j) = p_j\)</span>, e com <span class="math inline">\(q_j = 1 - p_j\)</span>.</p></li>
<li><p><span class="math inline">\(0 &lt; p_j &lt; 1\)</span>.</p></li>
<li><p>Uma pessoa sadia tem o sintoma <span class="math inline">\(W\)</span> com probabilidade <span class="math inline">\(w_0\)</span>.</p></li>
</ul>
</div>
<div class="rmdbox">
<ol style="list-style-type: lower-alpha">
<li>Achar <span class="math inline">\(P(W)\)</span>.</li>
</ol>
</div>
<ul>
<li>
<p>Por probabilidade total:</p>
<p><span class="math display">\[
\begin{aligned}
P(W)
&amp;= P(W \mid D_1 \cup D_2) \cdot P(D_1 \cup D_2) +
P(W \mid \neg(D_1 \cup D_2)) \cdot P(\neg(D_1 \cup D_2)) \\
&amp;= 1 \cdot (p_1 + p_2 - p_1p_2) + w_0 \cdot (1 - p_1 - p_2 + p_1p_2) \\
&amp;= p_1 + p_2 - p_1p_2 + w_0q_1q_2
\end{aligned}
\]</span></p>
</li>
</ul>
<div class="rmdbox">
<ol start="2" style="list-style-type: lower-alpha">
<li>Achar <span class="math inline">\(P(D_1 \mid W)\)</span>, <span class="math inline">\(P(D_2 \mid W)\)</span>, e <span class="math inline">\(P(D_1 \cap D_2 \mid W)\)</span>.</li>
</ol>
</div>
<ul>
<li>
<p>Por Bayes:</p>
<p><span class="math display">\[
\begin{aligned}
  P(D_1 \mid W)
  &amp;= \frac{P(W \mid D_1) \cdot P(D_1)}{P(W)} \\
  &amp;= \frac{1 \cdot p_1}{p_1 + p_2 - p_1p_2 + w_0q_1q_2} \\
  &amp;= \frac{p_1}{p_1 + p_2 - p_1p_2 + w_0q_1q_2}
\end{aligned}
\]</span></p>
</li>
<li>
<p>Analogamente,</p>
<p><span class="math display">\[
P(D_2 \mid W) = \frac{p_2}{p_1 + p_2 - p_1p_2 + w_0q_1q_2}
\]</span></p>
</li>
<li>
<p>Finalmente,</p>
<p><span class="math display">\[
\begin{aligned}
P(D_1 \cap D_2 \mid W)
&amp;= \frac{P(D_1 \cap D_2 \cap W)}{P(W)} \\
&amp;= \frac{P(D_1 \cap D_2)}{P(W)} &amp; (\text{pois }D_1 \cap D_2 \subseteq W)\\
&amp;= \frac{p_1p_2}{p_1 + p_2 - p_1p_2 + w_0q_1q_2}
\end{aligned}
\]</span></p>
</li>
</ul>
<div class="rmdbox">
<ol start="3" style="list-style-type: lower-alpha">
<li>
<span class="math inline">\(D_1\)</span> e <span class="math inline">\(D_2\)</span> são condicionalmente independentes, dado <span class="math inline">\(W\)</span>?</li>
</ol>
</div>
<ul>
<li>
<p>Basta verificar se</p>
<p><span class="math display">\[
P(D_1 \mid W) \cdot P(D_2 \mid W) = P(D_1 \cap D_2 \mid W)
\]</span></p>
</li>
<li>
<p>Isto equivale a</p>
<p><span class="math display">\[
\frac{p_1p_2}{(p_1 + p_2 - p_1p_2 + w_0q_1q_2)^2} =
\frac{p_1p_2}{p_1 + p_2 - p_1p_2 + w_0q_1q_2}
\]</span></p>
</li>
<li>
<p><span class="hl">Esta igualdade só é verdade se</span></p>
<ol style="list-style-type: decimal">
<li>
<p><span class="math inline">\(w_0 = 0\)</span> e <span class="math inline">\(P(D_1 \cup D_2) = 0\)</span> (o que é proibido pelo enunciado). Ninguém estaria doente, e ninguém teria o sintoma.</p>
<p>ou</p>
</li>
<li><p><span class="math inline">\(P(D_1 \cup D_2) = 1\)</span>. Aqui, todos estariam doentes, e todos teriam o sintoma.</p></li>
</ol>
</li>
<li>
<p>Lembramos que</p>
<p><span class="math display">\[
w_0 = P(W \mid \neg(D_1 \cup D_2)) =
\frac{P(W \cap \neg(D_1 \cup D_2))}{P(\neg(D_1 \cup D_2))}
\]</span></p>
</li>
<li><p>No caso (1) acima, <span class="math inline">\(w_0 = P(W) = 0\)</span>, e não faz mais sentido condicionar sobre <span class="math inline">\(W\)</span>.</p></li>
<li><p>No caso (2) acima, <span class="math inline">\(P(\neg(D_1 \cup D_2)) = 0\)</span>, e a própría definição de <span class="math inline">\(w_0\)</span> deixa de fazer sentido.</p></li>
</ul>
<div class="rmdbox">
<ol start="4" style="list-style-type: lower-alpha">
<li>Suponha que <span class="math inline">\(w_0 = 0\)</span>. Neste caso, <span class="math inline">\(D_1\)</span> e <span class="math inline">\(D_2\)</span> são condicionalmente independentes, dado <span class="math inline">\(W\)</span>?</li>
</ol>
</div>
<ul>
<li><p>Por causa do discutido no item (c), vamos supor que <span class="math display">\[0 &lt; P(D_1 \cup D_2) &lt; 1\]</span> para que possamos condicionar sobre <span class="math inline">\(W\)</span> e para que a definição de <span class="math inline">\(w_0\)</span> faça sentido.</p></li>
<li>
<p>Como no item (c), verificamos se</p>
<p><span class="math display">\[
P(D_1 \mid W) \cdot P(D_2 \mid W) = P(D_1 \cap D_2 \mid W)
\]</span></p>
</li>
<li>
<p>Que equivale a</p>
<p><span class="math display">\[
\frac{p_1p_2}{(p_1 + p_2 - p_1p_2)^2} =
\frac{p_1p_2}{p_1 + p_2 - p_1p_2}
\]</span></p>
</li>
<li><p>Isto é impossível, se <span class="math inline">\(0 &lt; P(D_1 \cup D_2) &lt; 1\)</span>.</p></li>
<li><p>Intuitivamente, <span class="math inline">\(D_1\)</span> e <span class="math inline">\(D_2\)</span> seriam <span class="hl">condicionalmente dependentes</span>, dado <span class="math inline">\(W\)</span>, pois, dado que uma pessoa tem o sintoma <span class="math inline">\(W\)</span>, saber que ela não tem a doença <span class="math inline">\(D_1\)</span> imediatamente nos diz que ela tem a doença <span class="math inline">\(D_2\)</span>.</p></li>
</ul>
<div class="rmdnote">
<p>Quando <span class="math inline">\(w_0 = 0\)</span> e <span class="math inline">\(0 &lt; P(D_1 \cup D_2) &lt; 1\)</span>, a consequência é que</p>
<p><span class="math display">\[
D_1 \cup D_2 = W
\]</span>
como eventos.</p>
<p>Daí, com as outras condições do enunciado, temos uma instância do <a href="probabilidade-condicional-continua%C3%A7%C3%A3o.html#paradoxo-de-berkson">paradoxo de Berkson</a>, com <span class="math inline">\(A = D_1\)</span> e <span class="math inline">\(B = D_2\)</span>.</p>
</div>
</div>
<div id="naïve-bayes" class="section level3 unnumbered">
<h3>38. Naïve Bayes<a class="anchor" aria-label="anchor" href="#na%C3%AFve-bayes"><i class="fas fa-link"></i></a>
</h3>
<div class="rmdbox">
<ul>
<li><p>Temos uma lista de <span class="math inline">\(100\)</span> palavras.</p></li>
<li><p>Evento <span class="math inline">\(W_j = {}\)</span> a palavra <span class="math inline">\(j\)</span> aparece no <em>email</em>.</p></li>
<li><p>Evento <span class="math inline">\(\text{spam} = {}\)</span> o <em>email</em> é <em>spam</em>.</p></li>
<li><p><span class="math inline">\(p = P(\text{spam})\)</span>.</p></li>
<li><p><span class="math inline">\(p_j = P(W_j \mid \text{spam})\)</span>.</p></li>
<li><p><span class="math inline">\(r_j = P(W_j \mid \neg \text{spam})\)</span>.</p></li>
<li>
<p>A <em>naïveté</em> do algoritmo consiste nas seguintes suposições — não-realistas, mas úteis:</p>
<ul>
<li><p>Os <span class="math inline">\(W_j\)</span> são condicionalmente independentes, dado <span class="math inline">\(\text{spam}\)</span>.</p></li>
<li><p>Os <span class="math inline">\(W_j\)</span> são condicionalmente independentes, dado <span class="math inline">\(\neg \text{spam}\)</span>.</p></li>
</ul>
</li>
<li><p>Um novo <em>email</em> é recebido. Contém as palavras <span class="math inline">\(23\)</span>, <span class="math inline">\(64\)</span>, e <span class="math inline">\(65\)</span>, e nenhuma das outras.</p></li>
<li>
<p>Vamos chamar de <span class="math inline">\(\vec W\)</span> a lista de eventos</p>
<p><span class="math display">\[
\begin{array}{l}
\neg W_1, \ldots, \neg W_{22}, \\
W_{23},\\
\neg W_{24}, \ldots, \neg W_{63},\\    
W_{64}, W_{65},\\
\neg W_{66}, \ldots, \neg W_{100}
\end{array}
\]</span></p>
</li>
<li><p>Calcular <span class="math inline">\(P\left( \text{spam} \;\middle|\; \vec W \right)\)</span>.</p></li>
</ul>
</div>
<ul>
<li>
<p>Por Bayes:</p>
<p><span class="math display">\[
P\left( \text{spam} \;\middle|\; \vec W \right) =
\frac{P\left(\vec W \;\middle|\; \text{spam} \right)}
{P\left( \vec W  \right)}
\]</span></p>
</li>
<li>
<p>Com a suposição <em>naïve</em>, podemos multiplicar as probabilidades condicionais:</p>
<p><span class="math display">\[
P\left(\vec W\;\middle|\; \text{spam} \right) =
p_{23} \cdot p_{64} \cdot p_{65} \cdot
\!\!\!\!\!\!\!\!\!
\prod_{
  \begin{array}{c}
  1 \leq j \leq 100. \\
  j \not\in \{ 23, 64, 65 \}
  \end{array}
}
\!\!\!\!\!\!\!
(1 - p_j)
\]</span></p>
<p><span class="hl">Vamos chamar este valor de <span class="math inline">\(m\)</span>.</span></p>
</li>
<li>
<p>Para calcular <span class="math inline">\(P\left( \vec W \right)\)</span>, usamos probabilidade total:</p>
<p><span class="math display">\[
\begin{aligned}
P\left( \vec W \right)
&amp;=
  P\left(\vec W \;\middle|\; \text{spam} \right)
  \cdot P(\text{spam})
  \;+\;
  P\left(\vec W \;\middle|\; \neg\text{spam} \right)
  \cdot P(\neg\text{spam})
\\
&amp;=
  m \cdot p \;+\; m' \cdot (1 - p)
\end{aligned}
\]</span></p>
<p>onde, de maneira análoga ao cálculo de <span class="math inline">\(m\)</span>,</p>
<p><span class="math display">\[
m' =
  r_{23} \cdot r_{64} \cdot r_{65} \cdot
\!\!\!\!\!\!\!\!\!
\prod_{
  \begin{array}{c}
  1 \leq j \leq 100. \\
  j \not\in \{ 23, 64, 65 \}
  \end{array}
}
\!\!\!\!\!\!\!
(1 - r_j)
\]</span></p>
</li>
<li>
<p>O valor procurado é, então,</p>
<p><span class="math display">\[
P\left( \text{spam} \;\middle|\; \vec W \right)
=
\frac{P\left(\vec W \;\middle|\; \text{spam} \right)}
{P\left( \vec W  \right)}
= \frac{mp}{mp + m'(1 - p)}
\]</span></p>
</li>
</ul>
</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="probabilidade-condicional.html">04: Probabilidade condicional</a></div>
<div class="next"><a href="refer%C3%AAncias.html">Referências</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="Nesta página"><h2>Nesta página</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#probabilidade-condicional-continua%C3%A7%C3%A3o">05: Probabilidade condicional (continuação)</a></li>
<li><a class="nav-link" href="#v%C3%ADdeo-4">Vídeo</a></li>
<li>
<a class="nav-link" href="#exerc%C3%ADcios-do-livro-cap.-2-1">Exercícios do livro (cap. 2)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#filho-mais-velho">30. Filho mais velho</a></li>
<li><a class="nav-link" href="#auto-independ%C3%AAncia">31. Auto-independência?</a></li>
<li><a class="nav-link" href="#dados-de-efron">32. Dados de Efron</a></li>
<li><a class="nav-link" href="#amigos">33. Amigos de Alice e Bob</a></li>
<li><a class="nav-link" href="#amostra">Extra: amostragem simples</a></li>
<li><a class="nav-link" href="#xadrez">35. Xadrez</a></li>
<li><a class="nav-link" href="#paradoxo-de-berkson">36. Paradoxo de Berkson</a></li>
<li><a class="nav-link" href="#doen%C3%A7as-e-sintoma">37. Doenças e sintoma</a></li>
<li><a class="nav-link" href="#na%C3%AFve-bayes">38. Naïve Bayes</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/fnaufel/???????/blob/master/05.Rmd">Ver código-fonte <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/fnaufel/???????/edit/master/05.Rmd">Editar esta página <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Introduction to Probability (Joe Blitzstein)</strong>" por Fernando Náufel (versão de 18/03/2022)</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Criado com o <a class="text-light" href="https://bookdown.org">pacote bookdown</a> do R.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
