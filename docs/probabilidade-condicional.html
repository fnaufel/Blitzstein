<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>04: Probabilidade condicional | Introduction to Probability (Joe Blitzstein)</title>
<meta name="author" content="Fernando Náufel">
<meta name="description" content="Vídeo   Exercícios do livro (cap. 2)  2  Uma mulher está grávida de meninos gêmeos. Gêmeos podem ser idênticos ou fraternos. \(1/3\) dos gêmeos são idênticos. Gêmeos idênticos têm \(50\%\) de...">
<meta name="generator" content="bookdown 0.24.7 with bs4_book()">
<meta property="og:title" content="04: Probabilidade condicional | Introduction to Probability (Joe Blitzstein)">
<meta property="og:type" content="book">
<meta property="og:description" content="Vídeo   Exercícios do livro (cap. 2)  2  Uma mulher está grávida de meninos gêmeos. Gêmeos podem ser idênticos ou fraternos. \(1/3\) dos gêmeos são idênticos. Gêmeos idênticos têm \(50\%\) de...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="04: Probabilidade condicional | Introduction to Probability (Joe Blitzstein)">
<meta name="twitter:description" content="Vídeo   Exercícios do livro (cap. 2)  2  Uma mulher está grávida de meninos gêmeos. Gêmeos podem ser idênticos ou fraternos. \(1/3\) dos gêmeos são idênticos. Gêmeos idênticos têm \(50\%\) de...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11.14/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/_Lexend-0.4.0/font.css" rel="stylesheet">
<link href="libs/_JetBrains%20Mono-0.4.0/font.css" rel="stylesheet">
<link href="libs/_Roboto-0.4.0/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="html_files/alterar_detalhes.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="html_files/styles_all.css">
<link rel="stylesheet" href="html_files/styles_book.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Ir para conteúdo principal</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Introduction to Probability (Joe Blitzstein)</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Mostrar sumário</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Buscar" aria-label="Buscar">
</form>

      <nav aria-label="Conteúdo"><h2>Conteúdo</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Apresentação</a></li>
<li><a class="" href="probabilidade-e-contagem.html">01: Probabilidade e contagem</a></li>
<li><a class="" href="hist%C3%B3rias-e-axiomas.html">02: Histórias e axiomas</a></li>
<li><a class="" href="problema-do-anivers%C3%A1rio-propriedades.html">03: Problema do aniversário, propriedades</a></li>
<li><a class="active" href="probabilidade-condicional.html">04: Probabilidade condicional</a></li>
<li><a class="" href="probabilidade-condicional-continua%C3%A7%C3%A3o.html">05: Probabilidade condicional (continuação)</a></li>
<li><a class="" href="refer%C3%AAncias.html">Referências</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/fnaufel/???????">Ver código-fonte do livro <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="probabilidade-condicional" class="section level1 unnumbered">
<h1>04: Probabilidade condicional<a class="anchor" aria-label="anchor" href="#probabilidade-condicional"><i class="fas fa-link"></i></a>
</h1>
<div id="vídeo-3" class="section level2 unnumbered">
<h2>Vídeo<a class="anchor" aria-label="anchor" href="#v%C3%ADdeo-3"><i class="fas fa-link"></i></a>
</h2>
<iframe src="https://www.youtube.com/embed/P7NE4WF8j-Q" width="100%" height="400px" data-external="1" class="center" style="width: 80%;">
</iframe>
</div>
<div id="exercícios-do-livro-cap.-2" class="section level2 unnumbered">
<h2>Exercícios do livro (cap. 2)<a class="anchor" aria-label="anchor" href="#exerc%C3%ADcios-do-livro-cap.-2"><i class="fas fa-link"></i></a>
</h2>
<div id="section-8" class="section level3 unnumbered">
<h3>2<a class="anchor" aria-label="anchor" href="#section-8"><i class="fas fa-link"></i></a>
</h3>
<div class="rmdbox">
<ul>
<li><p>Uma mulher está grávida de meninos gêmeos.</p></li>
<li><p>Gêmeos podem ser idênticos ou fraternos.</p></li>
<li><p><span class="math inline">\(1/3\)</span> dos gêmeos são idênticos.</p></li>
<li><p>Gêmeos idênticos têm <span class="math inline">\(50\%\)</span> de chance de serem ambos meninos, e <span class="math inline">\(50\%\)</span> de chance de serem ambos meninas.</p></li>
<li><p>Para gêmeos fraternos, cada gêmeo tem, independentemente, <span class="math inline">\(50\%\)</span> de chance de ser menino, e <span class="math inline">\(50\%\)</span> de chance de ser menina.</p></li>
<li><p>Qual a probabilidade de a mulher estar grávida de gêmeos idênticos?</p></li>
</ul>
</div>
<ul>
<li>
<p>Eventos:</p>
<p><span class="math display">\[
\begin{aligned}
I &amp;= \text{os gêmeos são idênticos} \\
M &amp;= \text{os gêmeos são dois meninos}
\end{aligned}
\]</span></p>
</li>
<li>
<p>Probabilidades dadas:</p>
<p><span class="math display">\[
\begin{aligned}
P(I) &amp;= 1/3 \\
P(M \mid I) &amp;= 1/2 \\
P(M \mid \neg I) &amp;= 1/4
\end{aligned}
\]</span></p>
</li>
<li>
<p>Queremos calcular <span class="math inline">\(P(I \mid M)\)</span>. Usamos Bayes:</p>
<p><span class="math display">\[
\begin{aligned}
P(I \mid M)
&amp;=
\frac{P(M \mid I) \cdot P(I)}{P(M)}
\end{aligned}
\]</span></p>
</li>
<li>
<p>Só falta o valor de <span class="math inline">\(P(M)\)</span>, que calculamos usando probabilidade total:</p>
<p><span class="math display">\[
\begin{aligned}
P(M)
&amp;=
P(M \mid I)P(I) + P(M \mid \neg I)P(\neg I) \\
&amp;=
1/2 \cdot 1/3 + 1/4 \cdot 2/3 \\
&amp;=
1/3
\end{aligned}
\]</span></p>
</li>
<li>
<p>Concluímos</p>
<p><span class="math display">\[
\begin{aligned}
P(I \mid M)
&amp;=
\frac{P(M \mid I) \cdot P(I)}{P(M)} \\
&amp;=
\frac{1/2 \cdot 1/3}{1/3} \\
&amp;=
1/2
\end{aligned}
\]</span></p>
</li>
</ul>
</div>
<div id="section-9" class="section level3 unnumbered">
<h3>4<a class="anchor" aria-label="anchor" href="#section-9"><i class="fas fa-link"></i></a>
</h3>
<div class="rmdbox">
<ul>
<li><p>Um aluno está resolvendo uma questão de múltipla escolha com <span class="math inline">\(n\)</span> opções.</p></li>
<li><p><span class="math inline">\(K\)</span> é o evento que corresponde a ele saber a resposta correta.</p></li>
<li><p><span class="math inline">\(R\)</span> é o evento que corresponde a ele acertar (sabendo ou chutando).</p></li>
<li><p>Se ele sabe a resposta, ele acerta.</p></li>
<li><p>Se ele não sabe, ele chuta uma opção ao acaso.</p></li>
<li><p>Considere <span class="math inline">\(P(K) = p\)</span>.</p></li>
</ul>
<ol style="list-style-type: lower-alpha">
<li><p>Ache <span class="math inline">\(P(K \mid R)\)</span>.</p></li>
<li><p>Mostre que <span class="math inline">\(P(K \mid R) \geq p\)</span>. Por que isto faz sentido? Quando a igualdade é exata?</p></li>
</ol>
</div>
<ol style="list-style-type: lower-alpha">
<li>
<p>Vamos usar Bayes, supondo <span class="math inline">\(p = P(K) &gt; 0\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
P(K \mid R)
&amp;=
\frac{P(R \mid K) \cdot P(K)}{P(R)} \\
&amp;=
\frac{1 \cdot p}{
  P(R \mid K) \cdot P(K) +
  P(R \mid \neg K) \cdot P(\neg K)
} \\
&amp;=
\frac{p}{
  1 \cdot p +
  \frac{1}{n} \cdot (1 - p)
} \\
&amp;=
\frac{np}{np + (1 - p)}
\end{aligned}
\]</span></p>
</li>
<li>
<p>Isto equivale a mostrar</p>
<p><span class="math display">\[
\frac{np}{np + (1 - p)} \geq p
\]</span></p>
<p>Como todos os valores são positivos, isto equivale a</p>
<p><span class="math display">\[
np \geq np^2 + (1 - p)p
\]</span></p>
<p>Dividindo ambos os lados por <span class="math inline">\(p &gt; 0\)</span>:</p>
<p><span class="math display">\[
n \geq np + 1 - p
\]</span></p>
<p>Daí,</p>
<p><span class="math display">\[
\begin{aligned}
n \geq np + 1 - p
&amp;\iff n - np \geq 1 - p \\
&amp;\iff n(1 - p) \geq 1 - p \\
&amp;\iff n \geq 1 &amp; \text{(supondo } p &lt; 1 \text{)}
\end{aligned}
\]</span>
O que é verdade, pois existe pelo menos uma opção (a correta).</p>
<p>Se <span class="math inline">\(p = 1\)</span>, a igualdade vale, e <span class="math inline">\(P(K \mid R) = 1\)</span>, pois o aluno sempre sabe a resposta e sempre acerta.</p>
<p>Se <span class="math inline">\(n = 1\)</span>, a igualdade vale, e <span class="math inline">\(P(K \mid R) = p\)</span>, pois o aluno acertar (ele sempre acerta!) e o aluno saber são independentes.</p>
<p>Imagine <span class="math inline">\(n &gt; 1\)</span>.</p>
<p>Lembre-se de que <span class="math inline">\(P(K \mid R) = \frac{P(K \cap R)}{P(R)}\)</span>.</p>
<p>O numerador é a probabilidade do evento “o aluno sabe e o aluno acerta”. Esta probabilidade é exatamente <span class="math inline">\(p\)</span>, pois “o aluno sabe” é sub-evento de “o aluno acerta”.</p>
<p>O numerador <span class="math inline">\(P(R)\)</span> é um número tal que <span class="math inline">\(0 &lt; P(R) &lt; 1\)</span>. Vamos chamar este número de <span class="math inline">\(1/x\)</span>, para <span class="math inline">\(x &gt; 1\)</span>.</p>
<p>Então,</p>
<p><span class="math display">\[
P(K \mid R) = \frac{P(K \cap R)}{P(R)} = \frac{p}{1/x} = xp &gt; p
\]</span></p>
</li>
</ol>
<div id="em-r" class="section level4 unnumbered">
<h4>Em R<a class="anchor" aria-label="anchor" href="#em-r"><i class="fas fa-link"></i></a>
</h4>
<p>Valores teóricos:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">9</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">.25</span><span class="op">)</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n</span>, p <span class="op">=</span> <span class="va">p</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>
    pkr_teorico <span class="op">=</span> <span class="va">n</span> <span class="op">*</span> <span class="va">p</span> <span class="op">/</span> <span class="op">(</span><span class="va">p</span> <span class="op">*</span> <span class="op">(</span><span class="va">n</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">arrange</span><span class="op">(</span><span class="va">n</span><span class="op">)</span>

<span class="va">df</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["n"],"name":[1],"type":["int"],"align":["right"]},{"label":["p"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["pkr_teorico"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"0,00","3":"0,0000000"},{"1":"1","2":"0,25","3":"0,2500000"},{"1":"1","2":"0,50","3":"0,5000000"},{"1":"1","2":"0,75","3":"0,7500000"},{"1":"1","2":"1,00","3":"1,0000000"},{"1":"2","2":"0,00","3":"0,0000000"},{"1":"2","2":"0,25","3":"0,4000000"},{"1":"2","2":"0,50","3":"0,6666667"},{"1":"2","2":"0,75","3":"0,8571429"},{"1":"2","2":"1,00","3":"1,0000000"},{"1":"3","2":"0,00","3":"0,0000000"},{"1":"3","2":"0,25","3":"0,5000000"},{"1":"3","2":"0,50","3":"0,7500000"},{"1":"3","2":"0,75","3":"0,9000000"},{"1":"3","2":"1,00","3":"1,0000000"},{"1":"4","2":"0,00","3":"0,0000000"},{"1":"4","2":"0,25","3":"0,5714286"},{"1":"4","2":"0,50","3":"0,8000000"},{"1":"4","2":"0,75","3":"0,9230769"},{"1":"4","2":"1,00","3":"1,0000000"},{"1":"5","2":"0,00","3":"0,0000000"},{"1":"5","2":"0,25","3":"0,6250000"},{"1":"5","2":"0,50","3":"0,8333333"},{"1":"5","2":"0,75","3":"0,9375000"},{"1":"5","2":"1,00","3":"1,0000000"},{"1":"6","2":"0,00","3":"0,0000000"},{"1":"6","2":"0,25","3":"0,6666667"},{"1":"6","2":"0,50","3":"0,8571429"},{"1":"6","2":"0,75","3":"0,9473684"},{"1":"6","2":"1,00","3":"1,0000000"},{"1":"7","2":"0,00","3":"0,0000000"},{"1":"7","2":"0,25","3":"0,7000000"},{"1":"7","2":"0,50","3":"0,8750000"},{"1":"7","2":"0,75","3":"0,9545455"},{"1":"7","2":"1,00","3":"1,0000000"},{"1":"8","2":"0,00","3":"0,0000000"},{"1":"8","2":"0,25","3":"0,7272727"},{"1":"8","2":"0,50","3":"0,8888889"},{"1":"8","2":"0,75","3":"0,9600000"},{"1":"8","2":"1,00","3":"1,0000000"},{"1":"9","2":"0,00","3":"0,0000000"},{"1":"9","2":"0,25","3":"0,7500000"},{"1":"9","2":"0,50","3":"0,9000000"},{"1":"9","2":"0,75","3":"0,9642857"},{"1":"9","2":"1,00","3":"1,0000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Gráfico:</p>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-24-1.png" width="100%" style="display: block; margin: auto;"></div>
<div class="rmdnote">
<p>Conclusão óbvia: quanto maior o número <span class="math inline">\(n\)</span> de opções, maior a probabilidade <span class="math inline">\(P(K \mid R)\)</span> de o aluno ter acertado sabendo, em oposição a ter acertado chutando:</p>
<p><span class="math display">\[
\begin{aligned}
\lim_{n \to \infty} P(K \mid R)
&amp;=
\lim_{n \to \infty} \frac{np}{np + 1 - p} \\
&amp;=
\lim_{n \to \infty} \frac{p}{p} \\
&amp;= 1
\end{aligned}
\]</span></p>
</div>
<p>Simulação:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sim</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span>, <span class="va">reps</span> <span class="op">=</span> <span class="fl">1e7</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="va">sabe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>, 
    <span class="va">reps</span>,
    replace <span class="op">=</span> <span class="cn">TRUE</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span>
  <span class="op">)</span>

  <span class="va">acerta</span> <span class="op">&lt;-</span> <span class="va">sabe</span>
  <span class="va">nao_sabe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="op">!</span><span class="va">sabe</span><span class="op">)</span>
  
  <span class="va">acerta</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="op">!</span><span class="va">sabe</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> 
    <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span>
      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>,
      <span class="va">nao_sabe</span>,
      replace <span class="op">=</span> <span class="cn">TRUE</span>,
      prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">n</span>, <span class="fl">1</span> <span class="op">-</span> <span class="fl">1</span><span class="op">/</span><span class="va">n</span><span class="op">)</span>
    <span class="op">)</span>
  
  <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">sabe</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">acerta</span><span class="op">)</span>
  
<span class="op">}</span>

<span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Vectorize.html">Vectorize</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>
    pkr_simulado <span class="op">=</span> <span class="fu">sim</span><span class="op">(</span><span class="va">n</span>, <span class="va">p</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">df</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["n"],"name":[1],"type":["int"],"align":["right"]},{"label":["p"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["pkr_teorico"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["pkr_simulado"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"0,00","3":"0,0000000","4":"0,0000000"},{"1":"1","2":"0,25","3":"0,2500000","4":"0,2502026"},{"1":"1","2":"0,50","3":"0,5000000","4":"0,4999832"},{"1":"1","2":"0,75","3":"0,7500000","4":"0,7504606"},{"1":"1","2":"1,00","3":"1,0000000","4":"1,0000000"},{"1":"2","2":"0,00","3":"0,0000000","4":"0,0000000"},{"1":"2","2":"0,25","3":"0,4000000","4":"0,3998505"},{"1":"2","2":"0,50","3":"0,6666667","4":"0,6666403"},{"1":"2","2":"0,75","3":"0,8571429","4":"0,8570665"},{"1":"2","2":"1,00","3":"1,0000000","4":"1,0000000"},{"1":"3","2":"0,00","3":"0,0000000","4":"0,0000000"},{"1":"3","2":"0,25","3":"0,5000000","4":"0,4999805"},{"1":"3","2":"0,50","3":"0,7500000","4":"0,7500388"},{"1":"3","2":"0,75","3":"0,9000000","4":"0,9000684"},{"1":"3","2":"1,00","3":"1,0000000","4":"1,0000000"},{"1":"4","2":"0,00","3":"0,0000000","4":"0,0000000"},{"1":"4","2":"0,25","3":"0,5714286","4":"0,5716879"},{"1":"4","2":"0,50","3":"0,8000000","4":"0,7999421"},{"1":"4","2":"0,75","3":"0,9230769","4":"0,9231010"},{"1":"4","2":"1,00","3":"1,0000000","4":"1,0000000"},{"1":"5","2":"0,00","3":"0,0000000","4":"0,0000000"},{"1":"5","2":"0,25","3":"0,6250000","4":"0,6247393"},{"1":"5","2":"0,50","3":"0,8333333","4":"0,8331971"},{"1":"5","2":"0,75","3":"0,9375000","4":"0,9373535"},{"1":"5","2":"1,00","3":"1,0000000","4":"1,0000000"},{"1":"6","2":"0,00","3":"0,0000000","4":"0,0000000"},{"1":"6","2":"0,25","3":"0,6666667","4":"0,6664028"},{"1":"6","2":"0,50","3":"0,8571429","4":"0,8572894"},{"1":"6","2":"0,75","3":"0,9473684","4":"0,9473386"},{"1":"6","2":"1,00","3":"1,0000000","4":"1,0000000"},{"1":"7","2":"0,00","3":"0,0000000","4":"0,0000000"},{"1":"7","2":"0,25","3":"0,7000000","4":"0,6999313"},{"1":"7","2":"0,50","3":"0,8750000","4":"0,8747860"},{"1":"7","2":"0,75","3":"0,9545455","4":"0,9544844"},{"1":"7","2":"1,00","3":"1,0000000","4":"1,0000000"},{"1":"8","2":"0,00","3":"0,0000000","4":"0,0000000"},{"1":"8","2":"0,25","3":"0,7272727","4":"0,7271878"},{"1":"8","2":"0,50","3":"0,8888889","4":"0,8891418"},{"1":"8","2":"0,75","3":"0,9600000","4":"0,9599143"},{"1":"8","2":"1,00","3":"1,0000000","4":"1,0000000"},{"1":"9","2":"0,00","3":"0,0000000","4":"0,0000000"},{"1":"9","2":"0,25","3":"0,7500000","4":"0,7503001"},{"1":"9","2":"0,50","3":"0,9000000","4":"0,8998653"},{"1":"9","2":"0,75","3":"0,9642857","4":"0,9642199"},{"1":"9","2":"1,00","3":"1,0000000","4":"1,0000000"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-27-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="section-10" class="section level3 unnumbered">
<h3>12<a class="anchor" aria-label="anchor" href="#section-10"><i class="fas fa-link"></i></a>
</h3>
<div class="rmdbox">
<ol style="list-style-type: lower-alpha">
<li>
<p>Alice está tentando enviar uma mensagem codificada em binário para Bob.</p>
<ul>
<li><p>Ela envia um <em>bit</em>: <span class="math inline">\(0\)</span> ou <span class="math inline">\(1\)</span> com probabilidades iguais.</p></li>
<li><p>Se ela envia <span class="math inline">\(0\)</span>, há probabilidade <span class="math inline">\(5\%\)</span> de erro.</p></li>
<li><p>Se ela envia <span class="math inline">\(1\)</span>, há probabilidade <span class="math inline">\(10\%\)</span> de erro.</p></li>
<li><p>Dado que Bob recebeu <span class="math inline">\(1\)</span>, qual a probabilidade de Alice ter enviado <span class="math inline">\(1\)</span>?</p></li>
</ul>
</li>
</ol>
</div>
<ul>
<li>
<p>Eventos e probabilidades:</p>
<div class="inline-figure"><img src="images/alice01.png" width="100%" style="display: block; margin: auto;"></div>
</li>
<li>
<p>Queremos achar <span class="math inline">\(P(A \mid B)\)</span>. Usando Bayes:</p>
<div class="inline-figure"><img src="images/alice02.png" width="75%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p0</span> <span class="op">&lt;-</span> <span class="fl">.05</span>
<span class="va">p1</span> <span class="op">&lt;-</span> <span class="fl">.1</span>
<span class="va">q0</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">p0</span>
<span class="va">q1</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">p1</span>

<span class="va">pA</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">/</span><span class="fl">2</span>
<span class="va">pBIA</span> <span class="op">&lt;-</span> <span class="va">q1</span>
<span class="va">pB</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">q1</span> <span class="op">+</span> <span class="va">p0</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span>
<span class="va">pAIB</span> <span class="op">&lt;-</span> <span class="va">pBIA</span> <span class="op">*</span> <span class="va">pA</span> <span class="op">/</span> <span class="va">pB</span>

<span class="va">pAIB</span>
<span class="co">## [1] 0,9473684</span></code></pre></div>
</li>
<li>
<p>Para sermos completos, vamos calcular outras probabilidades, com <span class="math inline">\(P(A) = P(\neg A) = 1/2\)</span>:</p>
<div class="inline-figure"><img src="images/alice03.png" width="50%" style="display: block; margin: auto;"></div>
<div class="inline-figure"><img src="images/alice04.png" width="50%" style="display: block; margin: auto;"></div>
</li>
<li>
<p>Simulação:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">reps</span> <span class="op">&lt;-</span> <span class="fl">1e7</span>
<span class="va">alice_envia</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, <span class="va">reps</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">bob_recebe</span> <span class="op">&lt;-</span> <span class="va">alice_envia</span>

<span class="va">bob_recebe</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">alice_envia</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, 
    <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">alice_envia</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span>,
    replace <span class="op">=</span> <span class="cn">TRUE</span>,
    prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">95</span><span class="op">/</span><span class="fl">100</span>, <span class="fl">5</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">bob_recebe</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">alice_envia</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> 
  <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, 
    <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">alice_envia</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,
    replace <span class="op">=</span> <span class="cn">TRUE</span>,
    <span class="co"># Atenção: aqui, erro é 1 virar 0:</span>
    prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span><span class="op">/</span><span class="fl">100</span>, <span class="fl">90</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span>  
  <span class="op">)</span>

<span class="va">pab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">alice_envia</span> <span class="op">&amp;</span> <span class="va">bob_recebe</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">bob_recebe</span><span class="op">)</span>
<span class="va">pab</span>
<span class="co">## [1] 0,9474936</span></code></pre></div>
</li>
</ul>
<div class="rmdbox">
<ol start="2" style="list-style-type: lower-alpha">
<li>
<p>Agora, eles usam um <span class="hl">código com repetição</span>:</p>
<ul>
<li><p>Alice envia <span class="math inline">\(000\)</span> para representar <span class="math inline">\(0\)</span> e <span class="math inline">\(111\)</span> para representar <span class="math inline">\(1\)</span>.</p></li>
<li><p>Bob decodifica a mensagem tomando o <em>bit</em> que está em maioria.</p></li>
<li><p>As probabilidades de erro são como antes, e os erros em <em>bits</em> diferentes são independentes.</p></li>
<li><p>Dado que Bob recebe <span class="math inline">\(110\)</span>, qual a probabilidade de que Alice tenha enviado <span class="math inline">\(111\)</span>?</p></li>
</ul>
</li>
</ol>
</div>
<ul>
<li>
<p>Eventos:</p>
<p><span class="math display">\[
\begin{aligned}
AAA &amp;= \text{Alice envia } 111 \\
BB\neg B &amp;= \text{Bob recebe } 110
\end{aligned}
\]</span></p>
</li>
<li><p><span class="math inline">\(P(AAA) = 1/2\)</span>, pois Alice envia somente <span class="math inline">\(111\)</span> ou <span class="math inline">\(000\)</span>.</p></li>
<li>
<p>Usando Bayes:</p>
<p><span class="math display">\[
P(AAA \mid BB\neg B) =
\frac{P(BB\neg B \mid AAA) \cdot P(AAA)}{P(BB\neg B)}
\]</span></p>
</li>
<li><p><span class="math inline">\(P(BB\neg B \mid AAA) = q_1 \cdot q_1 \cdot p_1\)</span>, pois erros em <em>bits</em> diferentes são independentes.</p></li>
<li>
<p>Pela lei da probabilidade total:</p>
<p><span class="math display">\[
\begin{aligned}
P(BB\neg B)
&amp;= P(BB\neg B \mid AAA) \cdot P(AAA) +
   P(BB\neg B \mid \neg(AAA))P(\neg(AAA)) \\
&amp;= \frac12 \cdot \left( q_1 \cdot q_1 \cdot p_1 +
   p_0 \cdot p_0 \cdot q-0 \right)
\end{aligned}
\]</span></p>
</li>
<li>
<p>Daí,</p>
<p><span class="math display">\[
\begin{aligned}
P(AAA \mid BB\neg B)
&amp;=
\frac{P(BB\neg B \mid AAA) \cdot P(AAA)}{P(BB\neg B)} \\
&amp;=
\frac{
  q_1 \cdot q_1 \cdot p_1 \cdot 1/2
}{
  \left( q_1 \cdot q_1 \cdot p_1 +
   p_0 \cdot p_0 \cdot q_0 \right)\cdot 1/2
} \\
&amp;=
\frac{
  q_1 \cdot q_1 \cdot p_1
}{
  \left( q_1 \cdot q_1 \cdot p_1 +
   p_0 \cdot p_0 \cdot q_0 \right)
}
\end{aligned}
\]</span></p>
</li>
<li>
<p>Numericamente:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">q1</span> <span class="op">*</span> <span class="va">q1</span> <span class="op">*</span> <span class="va">p1</span> <span class="op">/</span> <span class="op">(</span><span class="va">q1</span> <span class="op">*</span> <span class="va">q1</span> <span class="op">*</span> <span class="va">p1</span> <span class="op">+</span> <span class="va">p0</span> <span class="op">*</span> <span class="va">p0</span> <span class="op">*</span> <span class="va">q0</span><span class="op">)</span>
<span class="co">## [1] 0,9715142</span></code></pre></div>
</li>
</ul>
</div>
<div id="section-11" class="section level3 unnumbered">
<h3>14<a class="anchor" aria-label="anchor" href="#section-11"><i class="fas fa-link"></i></a>
</h3>
<div class="rmdbox">
<p>Se <span class="math inline">\(P(A), P(B) \in (0, 1)\)</span>, então</p>
<p><span class="math display">\[
P(A \mid B) &gt; P(A \mid \neg B) \iff
P(B \mid A) &gt; P(B \mid \neg A)
\]</span></p>
</div>
<p>???</p>
</div>
<div id="section-12" class="section level3 unnumbered">
<h3>15<a class="anchor" aria-label="anchor" href="#section-12"><i class="fas fa-link"></i></a>
</h3>
<div class="rmdbox">
<p><span class="math inline">\(A\)</span> e <span class="math inline">\(B\)</span> são eventos com</p>
<p><span class="math display">\[
0 &lt; P(A \cap B) &lt; P(A) &lt; P(B) &lt; P(A \cup B) &lt; 1
\]</span></p>
<p>Você está torcendo para que <span class="math inline">\(A\)</span> e <span class="math inline">\(B\)</span> <span class="hl">ambos</span> ocorram.</p>
<p>O que você ficaria mais feliz em observar?</p>
<ul>
<li><p>Que <span class="math inline">\(A\)</span> ocorreu?</p></li>
<li><p>Que <span class="math inline">\(B\)</span> ocorreu?</p></li>
<li><p>Que <span class="math inline">\(A \cup B\)</span> ocorreu?</p></li>
</ul>
</div>
<ul>
<li>
<p>Queremos observar o evento <span class="math inline">\(E\)</span> tal que <span class="math inline">\(P(A \cap B \mid E)\)</span> seja máximo.</p>
<p><span class="math display">\[
\begin{aligned}
P(A \cap B \mid A) &amp;= \frac{P(A \cap B)}{P(A)} \\
P(A \cap B \mid B) &amp;= \frac{P(A \cap B)}{P(B)} \\
P(A \cap B \mid A \cup B) &amp;=
  \frac{P((A \cap B) \cap (A \cup B))}{P(A \cup B)} \\
  &amp;= \frac{P(A \cap B)}{P(A \cup B)}
\end{aligned}
\]</span></p>
</li>
<li><p>Como <span class="math inline">\(P(A)\)</span> é o menor denominador, observar <span class="math inline">\(A\)</span> maximiza <span class="math inline">\(P(A \cap B \mid E)\)</span>.</p></li>
<li><p>Intuitivamente, como <span class="math inline">\(A\)</span> é o evento menos provável dos dois, saber que <span class="math inline">\(A\)</span> ocorreu nos deixa mais próximo da ocorrência dos dois eventos do que saber que <span class="math inline">\(B\)</span> (ou que algum dos dois) ocorreu.</p></li>
</ul>
</div>
<div id="section-13" class="section level3 unnumbered">
<h3>16<a class="anchor" aria-label="anchor" href="#section-13"><i class="fas fa-link"></i></a>
</h3>
<div class="rmdbox">
<p><span class="math display">\[
P(A \mid B) \leq P(A) \implies P(A \mid \neg B) \geq P(A)
\]</span></p>
</div>
<ul>
<li><p>Se a ocorrência de <span class="math inline">\(B\)</span> torna <span class="math inline">\(A\)</span> menos provável, então a não-ocorrência de <span class="math inline">\(B\)</span> torna <span class="math inline">\(A\)</span> mais provável.</p></li>
<li>
<p>Pela lei da probabilidade total:</p>
<p><span class="math display">\[
\begin{aligned}
P(A) &amp;= P(A \mid B)P(B) + P(A \mid \neg B)P(\neg B) \\
\therefore P(A \mid \neg B) &amp;=
  \frac{P(A) - P(A \mid B)P(B)}{P(\neg B)}
\end{aligned}
\]</span></p>
</li>
<li>
<p>Daí,</p>
<p><span class="math display">\[
\begin{aligned}
P(A \mid \neg B)
&amp;\geq
  \frac{P(A) - P(A)P(B)}{P(\neg B)} &amp; \text{pois } P(A \mid B) \leq P(A) \\
&amp;= \frac{P(A)(1 - P(B))}{P(\neg B)} \\
&amp;= P(A)
\end{aligned}
\]</span></p>
</li>
</ul>
</div>
<div id="section-14" class="section level3 unnumbered">
<h3>17<a class="anchor" aria-label="anchor" href="#section-14"><i class="fas fa-link"></i></a>
</h3>
<div class="rmdbox">
<p>Em lógica determinística, <span class="math inline">\(A \to B \iff \neg B \to \neg A\)</span>.</p>
<p>Em probabilidades?</p>
<p>Considere eventos <span class="math inline">\(A\)</span> e <span class="math inline">\(B\)</span> com <span class="math inline">\(P(A), P(B) \not\in \{0, 1\}\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>Mostre que <span class="math inline">\(P(B \mid A) = 1 \implies P(\neg A \mid \neg B) = 1\)</span>.</li>
</ol>
</div>
<ul>
<li>
<p><span class="math inline">\(A\)</span> está contido em <span class="math inline">\(B\)</span>:</p>
<p><span class="math display">\[
P(B \mid A) = 1
\iff \frac{P(A \cap B)}{P(A)} = 1
\iff P(A \cap B) = P(A)
\]</span></p>
</li>
<li>
<p>Vamos mostrar que <span class="math inline">\(P(\neg A \mid \neg B) = 1\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
P(\neg A \mid \neg B)
&amp;= \frac{P(\neg A \cap \neg B)}{P(\neg B)} \\
&amp;= \frac{P(\neg (A \cup B))}{P(\neg B)} \\
&amp;= \frac{1 - P(A \cup B)}{P(\neg B)} \\
&amp;= \frac{1 - \left[ P(A) + P(B) - P(A \cap B) \right]}{P(\neg B)} \\
&amp;= \frac{1 - P(B)}{P(\neg B)} \\
&amp;= \frac{P(\neg B)}{P(\neg B)} \\
&amp;= 1
\end{aligned}
\]</span></p>
</li>
</ul>
<div class="rmdbox">
<ol start="2" style="list-style-type: lower-alpha">
<li>Mostre que, se “<span class="math inline">\(=\)</span>” for substituído por “<span class="math inline">\(\approx\)</span>”, o resultado não vale. Ache um exemplo em que <span class="math inline">\(P(B \mid A)\)</span> seja quase <span class="math inline">\(1\)</span>, mas <span class="math inline">\(P(\neg A \mid \neg B)\)</span> seja quase <span class="math inline">\(0\)</span>.</li>
</ol>
</div>
<ul>
<li>
<p>Valores de exemplo, com <span class="math inline">\(A\)</span> e <span class="math inline">\(B\)</span> independentes:</p>
<p><span class="math display">\[
\begin{aligned}
P(A) &amp;= 80/100 \\
P(B) &amp;= 90/100 \\
P(\neg A) &amp;= 20/100 \\
P(\neg B) &amp;= 10/100 \\
P(A \cap B) &amp;= P(A) \cdot P(B) = 72/100 \\
P(A \cup B) &amp;= P(A) + P(B) - P(A \cap B) = 98/100\\
P(B \mid A) &amp;= \frac{P(A \cap B)}{P(A)} = 72/80 \approx 1 \\
P(\neg A \mid \neg B) &amp;= \frac{P(\neg A \cap \neg B)}{P(\neg B)} =
  \frac{1 - P(A \cup B)}{P(\neg B)} = 2/10 \approx 0
\end{aligned}
\]</span></p>
</li>
</ul>
<div class="rmdnote">
<p>Vamos criar uma medida de independência. Se <span class="math inline">\(P(A) \neq 0\)</span> e <span class="math inline">\(P(B) \neq 0\)</span>, definimos</p>
<p><span class="math display">\[
I = \frac{P(A \cap B)}{P(A)P(B)}
\]</span></p>
<p>Com isso,</p>
<ul>
<li><p><span class="math inline">\(A\)</span> e <span class="math inline">\(B\)</span> são disjuntos <span class="math inline">\({} \iff I = 0\)</span></p></li>
<li><p><span class="math inline">\(A\)</span> e <span class="math inline">\(B\)</span> são independentes <span class="math inline">\({} \iff I = 1\)</span></p></li>
<li>
<p><span class="math inline">\(A\)</span> e <span class="math inline">\(B\)</span> se atrapalham <span class="math inline">\({} \iff 0 &lt; I &lt; 1\)</span>.</p>
<p>I.e., <span class="math inline">\(P(A) &gt; P(A \mid B)\)</span> e <span class="math inline">\(P(B) &gt; P(B \mid A)\)</span>.</p>
</li>
<li>
<p><span class="math inline">\(A\)</span> e <span class="math inline">\(B\)</span> se ajudam <span class="math inline">\({} \iff I &gt; 1\)</span>.</p>
<p>I.e., <span class="math inline">\(P(A) &lt; P(A \mid B)\)</span> e <span class="math inline">\(P(B) &lt; P(B \mid A)\)</span>.</p>
</li>
</ul>
</div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-35-1.png" width="100%" style="display: block; margin: auto;"></div>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-36-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="section-15" class="section level3 unnumbered">
<h3>22<a class="anchor" aria-label="anchor" href="#section-15"><i class="fas fa-link"></i></a>
</h3>
<div class="rmdbox">
<p>Este problema foi proposto pela primeira vez por Lewis Carroll em 1893.</p>
<ul>
<li><p>Uma bolsa contém uma bola, que é ou azul, ou verde, com probabilidades iguais.</p></li>
<li><p>Uma bola verde é colocada na bolsa; agora, há <span class="math inline">\(2\)</span> bolas na bolsa.</p></li>
<li><p>Uma bola é retirada da bolsa ao acaso.</p></li>
<li><p>A bola retirada é verde.</p></li>
<li><p>Qual é a probabilidade de que a bola que sobrou na bolsa seja verde?</p></li>
</ul>
</div>
<ul>
<li>
<p>Antes de mais nada, vamos definir os eventos:</p>
<p><span class="math display">\[
\begin{aligned}
  O &amp;= \text{bola original é verde} \\
  R &amp;= \text{bola retirada é verde} \\
  S &amp;= \text{bola que sobrou é verde}
\end{aligned}
\]</span></p>
</li>
<li><p>O importante é perceber que o enunciado diz que o evento <span class="math inline">\(R\)</span> aconteceu, mas as probabilidades devem ser calculadas pensando em todos os resultados possíveis, <span class="hl">antes de o experimento acontecer.</span></p></li>
<li><p>Ou seja, em vez de tomar <span class="math inline">\(P(R) = 1\)</span> — <span class="hl">o que seria errado</span> — vamos calcular <span class="math inline">\(P(S \mid R)\)</span>: a probabilidade de que a bola que sobrou seja verde, <span class="hl">sabendo que a bola retirada foi verde.</span></p></li>
<li>
<p>Começamos com a lei da probabilidade total, condicionando aos dois casos possíveis:</p>
<p><span class="math display">\[
\begin{aligned}
P(S \mid R) &amp;=
\underbrace{P(S \mid R, O) \cdot P(O \mid R)}_{\text{caso 1: bola original verde}}
\;+\;
\underbrace{P(S \mid R, \neg O) \cdot P(\neg O \mid R)}_{\text{caso 2: bola original azul}}  
\end{aligned}
\]</span></p>
</li>
<li>
<p>No caso <span class="math inline">\(1\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
P(S \mid R, O) \cdot P(O \mid R)
&amp;= 1 \cdot P(O \mid R) \\
&amp;= P(O \mid R)
\end{aligned}
\]</span></p>
</li>
<li>
<p>No caso <span class="math inline">\(2\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
P(S \mid R, \neg O) \cdot P(\neg O \mid R)
&amp;= 0 \cdot P(\neg O \mid R) \\
&amp;= 0
\end{aligned}
\]</span></p>
<p>Isto faz sentido: <span class="hl">se a bola original era azul, não há como a bola que sobrou ser verde.</span></p>
</li>
<li>
<p>Só precisamos calcular a probabilidade do caso <span class="math inline">\(1\)</span>, que é <span class="math inline">\(P(O \mid R)\)</span>. Vamos usar Bayes:</p>
<p><span class="math display">\[
\begin{aligned}
P(O \mid R)
&amp;= \frac{P(R \mid O) \cdot P(O)}{P(R)} \\
&amp;= \frac{1 \cdot 1/2}{P(R)}
\end{aligned}
\]</span></p>
</li>
<li>
<p>Para calcular <span class="math inline">\(P(R)\)</span>, lei da probabilidade total de novo, condicionando sobre a bola original:</p>
<p><span class="math display">\[
\begin{aligned}
P(R)
&amp;= P(R \mid O) \cdot P(O) + P(R \mid \neg O) \cdot P(\neg O) \\
&amp;= 1 \cdot 1/2 + 1/2 \cdot 1/2 \\
&amp;= 3/4
\end{aligned}
\]</span></p>
</li>
<li>
<p>Chegamos a</p>
<p><span class="math display">\[
\begin{aligned}
P(O \mid R)
&amp;= \frac{P(R \mid O) \cdot P(O)}{P(R)} \\
&amp;= \frac{1 \cdot 1/2}{P(R)} \\
&amp;= \frac{1/2}{3/4} \\
&amp;= \frac{2}{3}
\end{aligned}
\]</span></p>
</li>
<li>
<p>Outra maneira de calcular <span class="math inline">\(P(S \mid R)\)</span> seria aplicar Bayes primeiro:</p>
<p><span class="math display">\[
P(S \mid R) = \frac{P(R \mid S) \cdot P(S)}{P(R)}
\]</span></p>
<p>mas as probabilidades do numerador são mais difíceis de calcular! Teríamos que usar a lei da probabilidade total duas vezes para o numerador (além de uma vez para o denominador).</p>
</li>
</ul>
</div>
<div id="section-16" class="section level3 unnumbered">
<h3>29<a class="anchor" aria-label="anchor" href="#section-16"><i class="fas fa-link"></i></a>
</h3>
<div class="rmdbox">
<p>Uma família tem <span class="math inline">\(2\)</span> crias.</p>
<p>Cada cria tem a mesma probabilidade de ser menino ou menina, e os sexos delas são independentes.</p>
<p>Cada cria tem a característica <span class="math inline">\(C\)</span> com probabilidade <span class="math inline">\(p\)</span>, independentemente uma da outra e do sexo.</p>
<p>Mostre que a probabilidade de serem <span class="hl">duas meninas</span>, dado que <span class="hl">pelo menos uma das crias é uma menina com a característica <span class="math inline">\(C\)</span></span>, é</p>
<p><span class="math display">\[
\frac{2 - p}{4 - p}
\]</span></p>
<p>Observe:</p>
<ul>
<li><p>Se <span class="math inline">\(p = 1\)</span>, então a probabilidade é <span class="math inline">\(1/3\)</span>, como no exemplo 2.2.5.</p></li>
<li><p>Se <span class="math inline">\(p \to 0\)</span>, então a probabilidade tende a <span class="math inline">\(1/2\)</span> pela esquerda, como no exemplo 2.2.7.</p></li>
</ul>
</div>
<ul>
<li>
<p>Eventos:</p>
<p><span class="math display">\[
\begin{aligned}
AA &amp;= \text{As duas são meninas} \\
AC &amp;= \text{Pelo menos uma é menina e tem } C
\end{aligned}
\]</span></p>
</li>
<li>
<p>Vamos usar Bayes:</p>
<p><span class="math display">\[
P(AA \mid AC) = \frac{P(AC \mid AA) \cdot P(AA)}{P(AC)}
\]</span></p>
</li>
<li>
<p>A probabilidade de ambas serem meninas é</p>
<p><span class="math display">\[
P(AA) = 1/4
\]</span></p>
</li>
<li>
<p>A probabilidade <span class="math inline">\(P(AC)\)</span> de pelo menos uma ser menina e ter <span class="math inline">\(C\)</span> é a soma das probabilidades de</p>
<ul>
<li><p>Ambas serem meninas, ambas terem <span class="math inline">\(C\)</span>: <span class="math inline">\(\frac14 \cdot p^2\)</span>.</p></li>
<li><p>Ambas serem meninas, só uma ter <span class="math inline">\(C\)</span> (a primeira ou a segunda): <span class="math inline">\(2 \cdot \frac14 \cdot p \cdot (1 - p)\)</span>.</p></li>
<li><p>Uma ser menina com <span class="math inline">\(C\)</span>, a outra ser menino (com ou sem <span class="math inline">\(C\)</span>): <span class="math inline">\(\frac12 \cdot p\)</span>.</p></li>
<li><p>Logo,
<span class="math display">\[
P(AC) = \frac{p \cdot (4 - p)}{4}
\]</span></p></li>
</ul>
</li>
<li>
<p>A probabilidade <span class="math inline">\(P(AC \mid AA)\)</span> de uma ser menina com <span class="math inline">\(C\)</span>, dado que ambas são meninas, é</p>
<p><span class="math display">\[
\begin{aligned}
P(AC \mid AA) &amp;= 1 - (1 - p)^2 \\
&amp;= p \cdot (2 - p)
\end{aligned}
\]</span></p>
</li>
<li>
<p>Juntando tudo:</p>
<p><span class="math display">\[
\begin{aligned}
P(AA \mid AC)
&amp;= \frac{P(AC \mid AA) P(AA)}{P(AC)} \\
&amp;= \frac
  {p \cdot (2 - p) \cdot 1/4}
  {p \cdot (4 - p) \cdot 1/4} \\
&amp;= \frac{2 - p}{4 - p}
\end{aligned}
\]</span></p>
</li>
<li>
<p>Um gráfico:</p>
<div class="inline-figure"><img src="_main_files/figure-html/unnamed-chunk-37-1.png" width="100%" style="display: block; margin: auto;"></div>
</li>
</ul>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="problema-do-anivers%C3%A1rio-propriedades.html">03: Problema do aniversário, propriedades</a></div>
<div class="next"><a href="probabilidade-condicional-continua%C3%A7%C3%A3o.html">05: Probabilidade condicional (continuação)</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="Nesta página"><h2>Nesta página</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#probabilidade-condicional">04: Probabilidade condicional</a></li>
<li><a class="nav-link" href="#v%C3%ADdeo-3">Vídeo</a></li>
<li>
<a class="nav-link" href="#exerc%C3%ADcios-do-livro-cap.-2">Exercícios do livro (cap. 2)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#section-8">2</a></li>
<li><a class="nav-link" href="#section-9">4</a></li>
<li><a class="nav-link" href="#section-10">12</a></li>
<li><a class="nav-link" href="#section-11">14</a></li>
<li><a class="nav-link" href="#section-12">15</a></li>
<li><a class="nav-link" href="#section-13">16</a></li>
<li><a class="nav-link" href="#section-14">17</a></li>
<li><a class="nav-link" href="#section-15">22</a></li>
<li><a class="nav-link" href="#section-16">29</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/fnaufel/???????/blob/master/04.Rmd">Ver código-fonte <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/fnaufel/???????/edit/master/04.Rmd">Editar esta página <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Introduction to Probability (Joe Blitzstein)</strong>" por Fernando Náufel (versão de 12/03/2022)</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>Criado com o <a class="text-light" href="https://bookdown.org">pacote bookdown</a> do R.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
